<html><head><title>misc::cronjobs::update_patrons_category</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Sun Dec 24 06:09:59 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#OPTIONS'>OPTIONS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#USAGE_EXAMPLES'>USAGE EXAMPLES</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>update_patrons_category.pl - Given a set of parameters update selected patrons from one catgeory to another.
Options are cumulative.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>update_patrons_category.pl -f=categorycode -t=categorycode [-b=branchcode] [--too_old] [--too_young] [-fo=X] [-fu=X] [-rb=date] [-ra=date] [-v] [--field column=value ...]</p>

<p>update_patrons_category.pl --help | --man</p>

<p>Options:</p>

<pre>   --help                   brief help message
   --man                    full documentation
   -too_old                 update if over  maximum age for current category
   -too_young               update if under minimuum age current category
   -fo=X --finesover=X      update if fines over X amount
   -fu=X --finesunder=X     update if fines under X amount
   -rb=date --regbefore     update if registration date is before given date
   -ra=date --regafter      update if registration date is after a given date
   -d --field name=value    where &#60;name&#62; is a column in the borrowers table, patrons will be updated if the field is equal to given &#60;value&#62;
   --where &#60;conditions&#62;     where clause to add to the query
   -v -verbose              verbose mode
   -c --confirm             commit changes to db, no action will be taken unless this switch is included
   -b --branch &#60;branchname&#62; only deal with patrons from this library/branch
   -f --from &#60;categorycode&#62; change patron category from this category
   -t --to   &#60;categorycode&#62; change patron category to this category</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="--help"
><b>--help</b></a></dt>

<dd>
<p>Print a brief help message and exits.</p>

<dt><a name="--man"
><b>--man</b></a></dt>

<dd>
<p>Prints the manual page and exits.</p>

<dt><a name="--verbose_|_-v"
><b>--verbose | -v</b></a></dt>

<dd>
<p>Verbose. Without this flag set, only fatal errors are reported.</p>

<dt><a name="--confirm_|_-c"
><b>--confirm | -c</b></a></dt>

<dd>
<p>Commit changes. Unless this flag set is, the script will report changes but not actually execute them on the database.</p>

<dt><a name="--branch_|_-b"
><b>--branch | -b</b></a></dt>

<dd>
<p>Changes patrons for one specific branch. Use the value in the branches.branchcode table.</p>

<dt><a name="--from_|_-f"
><b>--from | -f</b></a></dt>

<dd>
<p>*Required* Defines the category to update. Expects the code from categories.categorycode.</p>

<dt><a name="--to_|_-t"
><b>--to | -t</b></a></dt>

<dd>
<p>*Required* Defines the category patrons will be converted to. Expects the code from categories.categorycode.</p>

<dt><a name="--too_old"
><b>--too_old</b></a></dt>

<dd>
<p>Update patron only if they are above the maximum age range specified for the &#39;from&#39; category.</p>

<dt><a name="--too_young"
><b>--too_young</b></a></dt>

<dd>
<p>Update patron only if they are below the minimum age range specified for the &#39;from&#39; category.</p>

<dt><a name="--finesover=X_|_-fo=X"
><b>--finesover=X | -fo=X</b></a></dt>

<dd>
<p>Supply a number and only account with fines over this number will be updated.</p>

<dt><a name="--finesunder=X_|_-fu=X"
><b>--finesunder=X | -fu=X</b></a></dt>

<dd>
<p>Supply a number and only account with fines under this number will be updated.</p>

<dt><a name="--regbefore=date_|_-rb=date"
><b>--regbefore=date | -rb=date</b></a></dt>

<dd>
<p>Enter a date in ISO format YYYY-MM-DD and only patrons registered before this date wil be updated.</p>

<dt><a name="--regafter=date_|_-ra=date"
><b>--regafter=date | -ra=date</b></a></dt>

<dd>
<p>Enter a date in ISO format YYYY-MM-DD and only patrons registered after this date wil be updated.</p>

<dt><a name="--field_column=value_|_-d_column=value"
><b>--field column=value | -d column=value</b></a></dt>

<dd>
<p>Use this flag to specify a column in the borrowers table and update only patrons whose value in that column equals the value supplied (repeatable) A value of null will check for a field that is not set.</p>

<p>e.g. --field dateexpiry=2016-01-01 will update all patrons who expired on that date, useful for schools etc.</p>

<dt><a name="--where_$conditions"
><b>--where $conditions</b></a></dt>

<dd>
<p>Use this option to specify a condition built with columns from the borrowers table</p>

<p>e.g. --where &#39;email IS NULL&#39; will update all patrons with no value for email</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This script is designed to update patrons from one category to another.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USAGE_EXAMPLES"
>USAGE EXAMPLES</a></h1>

<p><code>update_patron_categories.pl</code> - Suggests that you read this help. :)</p>

<p><code>update_patron_categories.pl</code> -b=&#60;branchcode&#62; -f=&#60;categorycode&#62; -t=&#60;categorycode&#62; --confirm - Processes a single branch, and updates the patron categories from fromcat to tocat.</p>

<p><code>update_patron_categories.pl</code> -b=&#60;branchcode&#62; -f=&#60;categorycode&#62; -t=&#60;categorycode&#62; --too_old --confirm - Processes a single branch, and updates the patron categories from fromcat to tocat for patrons over the age range of fromcat.</p>

<p><code>update_patron_categories.pl</code> -f=&#60;categorycode&#62; -t=&#60;categorycode&#62; -v - Processes all branches, shows all messages, and reports the patrons who would be affected. Takes no action on the database.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
