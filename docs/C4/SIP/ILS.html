<html><head><title>ILS</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Tue Jul  4 12:14:29 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#INTRODUCTION'>INTRODUCTION</a>
  <li class='indexItem indexItem1'><a href='#INITIALIZATION'>INITIALIZATION</a>
  <li class='indexItem indexItem1'><a href='#BASIC_OBJECT_ACCESS_AND_PROTOCOL_SUPPORT'>BASIC OBJECT ACCESS AND PROTOCOL SUPPORT</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24inst_name_%3D_%24self-%3Einstitution%3B'>$inst_name = $self-&#62;institution;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24self-%3Esupport(%24operation)%3B'>$bool = $self-&#62;support($operation);</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24self-%3Echeckout_ok%3B'>$bool = $self-&#62;checkout_ok;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24self-%3Echeckin_ok%3B'>$bool = $self-&#62;checkin_ok;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24self-%3Estatus_update_ok%3B'>$bool = $self-&#62;status_update_ok;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24self-%3Eoffline_ok%3B'>$bool = $self-&#62;offline_ok;</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#THE_TRANSACTIONS'>THE TRANSACTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#CORE_TRANSACTION_STATUS_METHODS'>CORE TRANSACTION STATUS METHODS</a>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Echeckout(%24patron_id%2C_%24item_id%2C_%24sc_renew)'>$status = $ils-&#62;checkout($patron_id, $item_id, $sc_renew)</a>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Echeckin(%24item_id%2C_%24trans_date%2C_%24return_date%2C_%24current_loc%2C_%24item_props%2C_%24cancel)'>$status = $ils-&#62;checkin($item_id, $trans_date, $return_date, $current_loc, $item_props, $cancel)</a>
    <li class='indexItem indexItem2'><a href='#(%24status%2C_%24screen_msg%2C_%24print_line)_%3D_%24ils-%3Eend_patron_session(%24patron_id)'>($status, $screen_msg, $print_line) = $ils-&#62;end_patron_session($patron_id)</a>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Epay_fee(%24patron_id%2C_%24patron_pwd%2C_%24fee_amt%2C_%24fee_type%2C_%24pay_type%2C_%24fee_id%2C_%24trans_id%2C_%24currency)'>$status = $ils-&#62;pay_fee($patron_id, $patron_pwd, $fee_amt, $fee_type, $pay_type, $fee_id, $trans_id, $currency)</a>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Ecancel_hold(%24patron_id%2C_%24patron_pwd%2C_%24item_id%2C_%24title_id)%3B'>$status = $ils-&#62;cancel_hold($patron_id, $patron_pwd, $item_id, $title_id);</a>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Erenew_all(%24patron_id%2C_%24patron_pwd%2C_%24fee_ack)%3B'>$status = $ils-&#62;renew_all($patron_id, $patron_pwd, $fee_ack);</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ILS - Portability layer to interface between Open-SIP and ILS</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use ILS;

    # Initialize connection between SIP and the ILS
    my $ils = new ILS (institution =&#62; &#39;Foo Public Library&#39;);

    # Basic object access methods
    $inst_name = $self-&#62;institution;
    $bool = $self-&#62;support($operation);
    $self-&#62;check_inst_id($inst_name, &#34;error message&#34;);

    # Check to see if certain protocol options are permitted
    $bool = $self-&#62;checkout_ok;
    $bool = $self-&#62;checkin_ok;
    $bool = $self-&#62;status_update_ok;
    $bool = $self-&#62;offline_ok;

    $status = $ils-&#62;checkout($patron_id, $item_id, $sc_renew);

    $status = $ils-&#62;checkin($item_id, $trans_date, $return_date,
                            $current_loc, $item_props, $cancel);

    $status = $ils-&#62;end_patron_session($patron_id);

    $status = $ils-&#62;pay_fee($patron_id, $patron_pwd, $fee_amt,
                            $fee_type, $pay_type, $fee_id, $trans_id,
                            $currency);

    $status = $ils-&#62;add_hold($patron_id, $patron_pwd, $item_id,
                             $title_id, $expiry_date,
                             $pickup_locn, $hold_type, $fee_ack);

    $status = $ils-&#62;cancel_hold($patron_id, $patron_pwd,
                                $item_id, $title_id);

    $status = $ils-&#62;alter_hold($patron_id, $patron_pwd, $item_id,
                               $title_id, $expiry_date,
                               $pickup_locn, $hold_type,
                               $fee_ack);

    $status = $ils-&#62;renew($patron_id, $patron_pwd, $item_id,
                          $title_id, $no_block, $nb_due_date,
                          $third_party, $item_props, $fee_ack);

    $status = $ils-&#62;renew_all($patron_id, $patron_pwd, $fee_ack);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTRODUCTION"
>INTRODUCTION</a></h1>

<p>The ILS module defines a basic portability layer between the SIP server and the rest of the integrated library system. It is the responsibility of the ILS vendor to implement the functions defined by this interface. This allows the SIP server to be reasonably portable between ILS systems (of course, we won&#39;t know exactly <i>how</i> portable the interface is until it&#39;s been used by a second ILS.</p>

<p>Because no business logic is embedded in the SIP server code itself, the SIP protocol handler functions do almost nothing except decode the network messages and pass the parameters to the ILS module or one of its submodules, <code>ILS::Patron</code> and <code>ILS::Item</code>. The SIP protocol query messages (Patron Information, or Item Status, for example), are implemented within the SIP server code by fetching a Patron, or Item, record and then retrieving the relevant information from that record. See <a href="../../ILS/Patron.html" class="podlinkpod"
>ILS::Patron</a> and <a href="../../ILS/Item.html" class="podlinkpod"
>ILS::Item</a> for the details.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INITIALIZATION"
>INITIALIZATION</a></h1>

<p>The first thing the SIP server does, after a terminal has successfully logged in, is initialize the ILS module by calling</p>

<pre>    $ils = new ILS $institution</pre>

<p>where <code>$institution</code> is a hash ( institution =&#62; &#39;Foo Public Library&#39; ) describing the institution to which the terminal belongs. In general, this will be the single institution that the ILS supports, but it may be that in a consortial setting, the SIP server may support connecting to different ILSs based on the <code>$institution</code> of the terminal.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BASIC_OBJECT_ACCESS_AND_PROTOCOL_SUPPORT"
>BASIC OBJECT ACCESS AND PROTOCOL SUPPORT</a></h1>

<p>The <code>$ils</code> object supports a small set of simple access methods and methods that allow the SIP server to determine if certain protocol operations are permitted to the remote terminals.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$inst_name_=_$self-&#62;institution;"
><code>$inst_name = $self-&#62;institution;</code></a></h2>

<p>Returns the institution ID as a string, suitable for incorporating into a SIP response message.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$self-&#62;support($operation);"
><code>$bool = $self-&#62;support($operation);</code></a></h2>

<p>Reports whether this ILS implementation supports certain operations that are necessary to report information to the SIP terminal. The argument <code>$operation</code> is a string from this list:</p>

<dl>
<dt><a name="&#39;magnetic_media&#39;"
><code>&#39;magnetic media&#39;</code></a></dt>

<dd>
<p>Can the ILS properly report whether an item is (or contains) magnetic media, such as a videotape or a book with a floppy disk?</p>

<dt><a name="&#39;security_inhibit&#39;"
><code>&#39;security inhibit&#39;</code></a></dt>

<dd>
<p>Is the ILS capable of directing the terminal to ignore the security status of an item?</p>

<dt><a name="&#39;offline_operation&#39;"
><code>&#39;offline operation&#39;</code></a></dt>

<dd>
<p>Does the ILS allow self-check units to operate when unconnected to the ILS? That is, can a self-check unit check out items to patrons without checking the status of the items and patrons in real time?</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$self-&#62;checkout_ok;"
><code>$bool = $self-&#62;checkout_ok;</code></a></h2>

<p>Are the self service terminals permitted to check items out to patrons?</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$self-&#62;checkin_ok;"
><code>$bool = $self-&#62;checkin_ok;</code></a></h2>

<p>Are the self service terminals permitted to check items in?</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$self-&#62;status_update_ok;"
><code>$bool = $self-&#62;status_update_ok;</code></a></h2>

<p>Are the self service terminals permitted to update patron status information. For example, can terminals block patrons?</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$self-&#62;offline_ok;"
><code>$bool = $self-&#62;offline_ok</code>;</a></h2>

<p>Are the self service terminals permitted to operate off-line. That is, can they perform their core self service operations when not in communication with the ILS?</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="THE_TRANSACTIONS"
>THE TRANSACTIONS</a></h1>

<p>In general, every protocol transaction that changes the status of some ILS object (Patron or Item) has a corresponding <code>ILS</code> method. Operations like <code>Check In</code>, which are a function of both a patron and an item are <code>ILS</code> functions, while others, like <code>Patron Status</code> or <code>Item Status</code>, which only depend on one type of object, are methods of the corresponding sub-module.</p>

<p>In the stub implementation provided with the SIP system, the <code>$status</code> objects returned by the various <code>ILS</code> transactions are objects that are subclasses of a virtual <code>ILS::Transaction</code> object, but this is not required of the SIP code, as long as the status objects support the appropriate methods.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CORE_TRANSACTION_STATUS_METHODS"
>CORE TRANSACTION STATUS METHODS</a></h2>

<p>The <code>$status</code> objects returned by all transactions must support the following common methods:</p>

<dl>
<dt><a name="ok"
><code>ok</code></a></dt>

<dd>
<p>Returns <code>true</code> if the transaction was successful and <code>false</code> if not. Other methods can be used to find out what went wrong.</p>

<dt><a name="item"
><code>item</code></a></dt>

<dd>
<p>Returns an <code>ILS::Item</code> object corresponding to the item with the barcode <code>$item_id</code>, or <code>undef</code> if the barcode is invalid.</p>

<dt><a name="patron"
><code>patron</code></a></dt>

<dd>
<p>Returns a <code>ILS::Patron</code> object corresponding to the patron with the barcode <code>$patron_id</code>, or <code>undef</code> if the barcode is invalid (ie, nonexistent, as opposed to &#34;expired&#34; or &#34;delinquent&#34;).</p>

<dt><a name="screen_msg"
><code>screen_msg</code></a></dt>

<dd>
<p>Optional. Returns a message that is to be displayed on the terminal&#39;s screen. Some self service terminals read the value of this string and act based on it. The configuration of the terminal, and the ILS implementation of this method will have to be coordinated.</p>

<dt><a name="print_line"
><code>print_line</code></a></dt>

<dd>
<p>Optional. Returns a message that is to be printed on the terminal&#39;s receipt printer. This message is distinct from the basic transactional information that the terminal will be printing anyway (such as, the basic checkout information like the title and due date).</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;checkout($patron_id,_$item_id,_$sc_renew)"
><code>$status = $ils-&#62;checkout($patron_id, $item_id, $sc_renew)</code></a></h2>

<p>Check out (or possibly renew) item with barcode <code>$item_id</code> to the patron with barcode <code>$patron_id</code>. If <code>$sc_renew</code> is true, then the self-check terminal has been configured to allow self-renewal of items, and the ILS may take this into account when deciding how to handle the case where <code>$item_id</code> is already checked out to <code>$patron_id</code>.</p>

<p>The <code>$status</code> object returned by <code>checkout</code> must support the following methods:</p>

<dl>
<dt><a name="renewal_ok"
><code>renewal_ok</code></a></dt>

<dd>
<p>Is this transaction actually a renewal? That is, did <code>$patron_id</code> already have <code>$item_id</code> checked out?</p>

<dt><a name="desensitize"
><code>desensitize</code></a></dt>

<dd>
<p>Should the terminal desensitize the item? This will be false for magnetic media, like videocassettes, and for &#34;in library&#34; items that are checked out to the patron, but not permitted to leave the building.</p>

<dt><a name="security_inhibit"
><code>security_inhibit</code></a></dt>

<dd>
<p>Should self checkout unit ignore the security status of this item?</p>

<p>This method will only be used if</p>

<pre>    $ils-&#62;supports(&#39;security inhibit&#39;)</pre>

<p>returns <code>true</code>.</p>

<dt><a name="fee_amount"
><code>fee_amount</code></a></dt>

<dd>
<p>If there is a fee associated with the use of <code>$item_id</code>, then this method should return the amount of the fee, otherwise it should return zero. See also the <code>sip_currency</code> and <code>sip_fee_type</code> methods.</p>

<dt><a name="sip_currency"
><code>sip_currency</code></a></dt>

<dd>
<p>The ISO currency code for the currency in which the fee associated with this item is denominated. For example, &#39;USD&#39; or &#39;CAD&#39;.</p>

<dt><a name="sip_fee_type"
><code>sip_fee_type</code></a></dt>

<dd>
<p>A code indicating the type of fee associated with this item. See the table in the protocol specification for the complete list of standard values that this function can return.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;checkin($item_id,_$trans_date,_$return_date,_$current_loc,_$item_props,_$cancel)"
><code>$status = $ils-&#62;checkin($item_id, $trans_date, $return_date, $current_loc, $item_props, $cancel)</code></a></h2>

<p>Check in item identified by barcode <code>$item_id</code>. This transaction took place at time <code>$trans_date</code> and was effective <code>$return_date</code> (to allow for backdating of items to when the branch closed, for example). The self check unit which received the item is located at <code>$current_loc</code>, and the item has properties <code>$item_props</code>. The parameters <code>$current_loc</code> and <code>$item_props</code> are opaque strings passed from the self service unit to the ILS untranslated. The configuration of the terminal, and the ILS implementation of this method will have to be coordinated.</p>

<p>The <code>$status</code> object returned by the <code>checkin</code> operation must support the following methods:</p>

<dl>
<dt><a name="resensitize"
><code>resensitize</code></a></dt>

<dd>
<p>Does the item need to be resensitized by the self check unit?</p>

<dt><a name="alert"
><code>alert</code></a></dt>

<dd>
<p>Should the self check unit generate an audible alert to notify staff that the item has been returned?</p>

<dt><a name="sort_bin"
><code>sort_bin</code></a></dt>

<dd>
<p>Certain self checkin units provide for automated sorting of the returned items. This function returns the bin number into which the received item should be placed. This function may return the empty string, or <code>undef</code>, to indicate that no sort bin has been specified.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="($status,_$screen_msg,_$print_line)_=_$ils-&#62;end_patron_session($patron_id)"
><code>($status, $screen_msg, $print_line) = $ils-&#62;end_patron_session($patron_id)</code></a></h2>

<p>This function informs the ILS that the current patron&#39;s session has ended. This allows the ILS to free up any internal state that it may be preserving between messages from the self check unit. The function returns a boolean <code>$status</code>, where <code>true</code> indicates success, and two strings: a screen message to display on the self check unit&#39;s console, and a print line to be printed on the unit&#39;s receipt printer.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;pay_fee($patron_id,_$patron_pwd,_$fee_amt,_$fee_type,_$pay_type,_$fee_id,_$trans_id,_$currency)"
><code>$status = $ils-&#62;pay_fee($patron_id, $patron_pwd, $fee_amt, $fee_type, $pay_type, $fee_id, $trans_id, $currency)</code></a></h2>

<p>Reports that the self check terminal handled fee payment from patron <code>$patron_id</code> (who has password <code>$patron_pwd</code>, which is an optional parameter). The other parameters are:</p>

<dl>
<dt><a name="$fee_amt"
><code>$fee_amt</code></a></dt>

<dd>
<p>The amount of the fee.</p>

<dt><a name="$fee_type"
><code>$fee_type</code></a></dt>

<dd>
<p>The type of fee, according a table in the SIP protocol specification.</p>

<dt><a name="$pay_type"
><code>$pay_type</code></a></dt>

<dd>
<p>The payment method. Defined in the SIP protocol specification.</p>

<dt><a name="$fee_id"
><code>$fee_id</code></a></dt>

<dd>
<p>Optional. Identifies which particular fee was paid. This identifier would have been sent from the ILS to the Self Check unit by a previous &#34;Patron Information Response&#34; message.</p>

<dt><a name="$trans_id"
><code>$trans_id</code></a></dt>

<dd>
<p>Optional. A transaction identifier set by the payment device. This should be recorded by the ILS for financial tracking purposes.</p>

<dt><a name="$currency"
><code>$currency</code></a></dt>

<dd>
<p>An ISO currency code indicating the currency in which the fee was paid.</p>
</dd>
</dl>

<p>The status object returned by the <code>pay_fee</code> must support the following methods:</p>

<dl>
<dt><a name="transaction_id"
><code>transaction_id</code></a></dt>

<dd>
<p>Transaction identifier of the transaction. This parallels the optional <code>$trans_id</code> sent from the terminal to the ILS. This may return an empty string.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'

><code>$status = $ils-&#62;add_hold($patron_id, $patron_pwd, $item_id, $title_id, $expiry_date, $pickup_locn, $hold_type, $fee_ack);</code></a></h2>

<p>Places a hold for <code>$patron_id</code> (optionally, with password <code>$patron_pwd</code>) on the item described by either <code>$item_id</code> or <code>$title_id</code>. The other parameters are:</p>

<dl>
<dt><a name="$expiry_date"
><code>$expiry_date</code></a></dt>

<dd>
<p>The date on which the hold should be cancelled. This date is a SIP protocol standard format timestamp:</p>

<pre>    YYYYMMDDZZZZHHMMSS</pre>

<p>where the &#39;Z&#39; characters indicate spaces.</p>

<dt><a name="$pickup_location"
><code>$pickup_location</code></a></dt>

<dd>
<p>The location at which the patron wishes to pick up the item when it&#39;s available. The configuration of the terminal, and the ILS implementation of this parameter will have to be coordinated.</p>

<dt><a name="$hold_type"
><code>$hold_type</code></a></dt>

<dd>
<p>The type of hold being placed: any copy, a specific copy, any copy from a particular branch or location. See the SIP protocol specification for the exact values that this parameter might take.</p>

<dt><a name="$fee_ack"
><code>$fee_ack</code></a></dt>

<dd>
<p>Boolean. If true, the patron has acknowleged that she is willing to pay the fee associated with placing a hold on this item. If <code>$fee_ack</code> is false, then the ILS should refuse to place the hold.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;cancel_hold($patron_id,_$patron_pwd,_$item_id,_$title_id);"
><code>$status = $ils-&#62;cancel_hold($patron_id, $patron_pwd, $item_id, $title_id);</code></a></h2>

<p>Cancel a hold placed by <code>$patron_id</code> for the item identified by <code>$item_id</code> or <code>$title_id</code>. The patron password <code>$patron_pwd</code> may be <code>undef</code>, if it was not provided by the terminal.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'

><code>$status = $ils-&#62;alter_hold($patron_id, $patron_pwd, $item_id, $title_id, $expiry_date, $pickup_locn, $hold_type, $fee_ack);</code></a></h2>

<p>The <code>$status</code> object returned by <code>$ils-&#62;add_hold</code>, <code>$ils-&#62;cancel_hold</code>, and <code>$ils-&#62;alter_hold</code> must all support the same methods:</p>

<dl>
<dt><a name="expiration_date"
><code>expiration_date</code></a></dt>

<dd>
<p>Returns the expiry date for the placed hold, in seconds since the epoch.</p>

<dt><a name="queue_position"
><code>queue_position</code></a></dt>

<dd>
<p>Returns the new hold&#39;s place in the queue of outstanding holds.</p>

<dt><a name="pickup_location"
><code>pickup_location</code></a></dt>

<dd>
<p>Returns the location code for the pickup location.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'

><code>$status = $ils-&#62;renew($patron_id, $patron_pwd, $item_id, $title_id, $no_block, $nb_due_date, $third_party, $item_props, $fee_ack);</code></a></h2>

<p>Renew the item identified by <code>$item_id</code> or <code>$title_id</code>, as requested by <code>$patron_id</code> (with password <code>$patron_pwd</code>). The item has the properties <code>$item_props</code> associated with it.</p>

<p>If the patron renewed the item while the terminal was disconnected from the net, then it is a <code>$no_block</code> transaction, and the due date assigned by the terminal, and reported to the patron was <code>$nb_due_date</code> (so we have to honor it).</p>

<p>If there is a fee associated with renewing the item, and the patron has agreed to pay the fee, then <code>$fee_ack</code> will be <code>&#39;Y&#39;</code>.</p>

<p>If <code>$third_party</code> is <code>&#39;Y&#39;</code> and the book is not checked out to <code>$patron_id</code>, but to some other person, then this is a third-party renewal; the item should be renewed for the person to whom it is checked out, rather than checking it out to <code>$patron_id</code>, or the renewal should fail.</p>

<p>The <code>$status</code> object returned by <code>$ils-&#62;renew</code> must support the following methods:</p>

<dl>
<dt><a name="renewal_ok"
><code>renewal_ok</code></a></dt>

<dd>
<p>Boolean. If <code>renewal_ok</code> is true, then the item was already checked out to the patron, so it is being renewed. If <code>renewal_ok</code> is false, then the patron did not already have the item checked out.</p>

<p>NOTE: HOW IS THIS USED IN PRACTICE?</p>

<dt><a name="desensitize,_security_inhibit,_fee_amount,_sip_currency,_sip_fee_type,_transaction_id"
><code>desensitize</code>, <code>security_inhibit</code>, <code>fee_amount</code>, <code>sip_currency</code>, <code>sip_fee_type</code>, <code>transaction_id</code></a></dt>

<dd>
<p>See <code>$ils-&#62;checkout</code> for these methods.</p>
</dd>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;renew_all($patron_id,_$patron_pwd,_$fee_ack);"
><code>$status = $ils-&#62;renew_all($patron_id, $patron_pwd, $fee_ack);</code></a></h2>

<p>Renew all items checked out by <code>$patron_id</code> (with password <code>$patron_pwd</code>). If the patron has agreed to pay any fees associated with this transaction, then <code>$fee_ack</code> will be <code>&#39;Y&#39;</code>.</p>

<p>The <code>$status</code> object must support the following methods:</p>

<dl>
<dt><a name="renewed"
><code>renewed</code></a></dt>

<dd>
<p>Returns a list of the <code>$item_id</code>s of the items that were renewed.</p>

<dt><a name="unrenewed"
><code>unrenewed</code></a></dt>

<dd>
<p>Returns a list of the <code>$item_id</code>s of the items that were not renewed.</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
