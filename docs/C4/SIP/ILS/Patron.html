<html><head><title>ILS::Patron</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.43,
  using Pod::Simple::PullParser v3.43,
  under Perl v5.032000 at Wed Dec  7 23:08:55 2022 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#INITIALIZATION'>INITIALIZATION</a>
  <li class='indexItem indexItem1'><a href='#BASIC_OBJECT_ACCESS_METHODS'>BASIC OBJECT ACCESS METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24str_%3D_%24patron-%3Esip_birthdate%3B'>$str = $patron-&#62;sip_birthdate;</a>
    <li class='indexItem indexItem2'><a href='#%24str_%3D_%24patron-%3Eptype%3B'>$str = $patron-&#62;ptype;</a>
    <li class='indexItem indexItem2'><a href='#%24str_%3D_%24patron-%3Elanguage%3B'>$str = $patron-&#62;language;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24patron-%3Echeck_password(%24password)%3B'>$bool = $patron-&#62;check_password($password);</a>
    <li class='indexItem indexItem2'><a href='#%24str_%3D_%24patron-%3Ecurrency%3B'>$str = $patron-&#62;currency;</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#CHECKING_PATRON_PERMISSIONS'>CHECKING PATRON PERMISSIONS</a>
  <li class='indexItem indexItem1'><a href='#LISTS_OF_ITEMS_ASSOCIATED_WITH_THE_USER'>LISTS OF ITEMS ASSOCIATED WITH THE USER</a>
  <li class='indexItem indexItem1'><a href='#PATRON_BORROWING_ACTIVITY'>PATRON BORROWING ACTIVITY</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24num_%3D_%24patron-%3Efee_amount%3B'>$num = $patron-&#62;fee_amount;</a>
    <li class='indexItem indexItem2'><a href='#%24bool_%3D_%24patron-%3Edrop_hold(%24item_id)%3B'>$bool = $patron-&#62;drop_hold($item_id);</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#CHANGING_A_PATRON%27S_STATUS'>CHANGING A PATRON&#39;S STATUS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#%24status_%3D_%24ils-%3Eblock(%24card_retained%2C_%24blocked_card_msg)%3B'>$status = $ils-&#62;block($card_retained, $blocked_card_msg);</a>
    <li class='indexItem indexItem2'><a href='#%24patron-%3Eenable%3B'>$patron-&#62;enable;</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>ILS::Patron - Portable Patron status object class for SIP</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>A <code>ILS::Patron</code> object holds information about a patron that&#39;s used by self service terminals to authenticate and authorize a patron,
and to display information about the patron&#39;s borrowing activity.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>        use ILS;
        use ILS::Patron;

        # Look up patron based on patron_id
        my $patron = new ILS::Patron $patron_id

        # Basic object access methods
        $patron_id = $patron-&#62;id;
        $str = $patron-&#62;name;
        $str = $patron-&#62;address;
        $str = $patron-&#62;email_addr;
        $str = $patron-&#62;home_phone;
        $str = $patron-&#62;sip_birthdate;  
        $str = $patron-&#62;ptype;
        $str = $patron-&#62;language;
        $str = $patron-&#62;password;
        $str = $patron-&#62;check_password($password);
        $str = $patron-&#62;currency;
        $str = $patron-&#62;screen_msg;
        $str = $patron-&#62;print_line;

        # Check patron permissions 
        $bool = $patron-&#62;charge_ok;
        $bool = $patron-&#62;renew_ok;
        $bool = $patron-&#62;recall_ok;
        $bool = $patron-&#62;hold_ok;
        $bool = $patron-&#62;card_lost;
        $bool = $patron-&#62;too_many_charged;
        $bool = $patron-&#62;too_many_overdue;
        $bool = $patron-&#62;too_many_renewal;
        $bool = $patron-&#62;too_many_claim_return;
        $bool = $patron-&#62;too_many_lost;
        $bool = $patron-&#62;excessive_fines;
        $bool = $patron-&#62;excessive_fees;
        $bool = $patron-&#62;too_many_billed;

        # Patron borrowing activity
        $num = $patron-&#62;recall_overdue;
        $num = $patron-&#62;fee_amount;
        $bool = $patron-&#62;drop_hold($item_id);
        @holds = $patron-&#62;hold_items($start, $end);
        @items = $patron-&#62;overdue_items($start, $end);
        @items = $patron-&#62;charged_items($start, $end);
        @items = $patron-&#62;fine_items($start, $end);
        @items = $patron-&#62;recall_items($start, $end);
        @items = $patron-&#62;unavail_holds($start, $end);

        # Changing a patron&#39;s status
        $patron-&#62;block($card_retained, $blocked_msg);
        $patron-&#62;enable;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INITIALIZATION"
>INITIALIZATION</a></h1>

<p>A patron object is created by calling</p>

<pre>        $patron = new ILS::Patron $patron_id;</pre>

<p>where <code>$patron_id</code> is the patron&#39;s barcode as received from the self service terminal. If the patron barcode is not registered, then <code>new</code> should return <code>undef</code>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BASIC_OBJECT_ACCESS_METHODS"
>BASIC OBJECT ACCESS METHODS</a></h1>

<p>The following functions return the corresponding information about the given patron, or <code>undef</code> if the information is unavailable.</p>

<pre>        $patron_id = $patron-E&#60;gt&#62;id;
        $str = $patron-E&#60;gt&#62;name;
        $str = $patron-E&#60;gt&#62;address;
        $str = $patron-E&#60;gt&#62;email_addr;
        $str = $patron-E&#60;gt&#62;home_phone;

        $str = $patron-E&#60;gt&#62;screen_msg;
        $str = $patron-E&#60;gt&#62;print_line;</pre>

<p>If there are outstanding display messages associated with the patron, then these return the screen message and print line, respectively, as with the <code>ILS</code> methods.</p>

<p>There are a few other object access methods that need a bit more explication however.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$str_=_$patron-&#62;sip_birthdate;"
><code>$str = $patron-&#62;sip_birthdate;</code></a></h2>

<p>Returns the patron&#39;s birthday formatted according to the SIP specification:</p>

<pre>        YYYYMMDD    HHMMSS</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$str_=_$patron-&#62;ptype;"
><code>$str = $patron-&#62;ptype;</code></a></h2>

<p>Returns the &#34;patron type&#34; of the patron. This is not used by the SIP server code, but is passed through to the self service terminal (using the non-standard protocol field &#34;PC&#34;). Some self service terminals use the patron type in determining what level of service to provide (for example, Envisionware computer management software can be configured to filter internet access based on patron type).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$str_=_$patron-&#62;language;"
><code>$str = $patron-&#62;language;</code></a></h2>

<p>A three-digit string encoding the patron&#39;s preferred language. The full list is defined in the SIP specification, but some of the important values are:</p>

<pre>        000 Unknown (default)
        001 English
        002 French
        008 Spanish
        011 Canadian French
        016 Arabic
        019 Chinese
        021 North American Spanish</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$patron-&#62;check_password($password);"
><code>$bool = $patron-&#62;check_password($password);</code></a></h2>

<p>Returns <code>true</code> if <code>$patron</code>&#39;s password is <code>$password</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$str_=_$patron-&#62;currency;"
><code>$str = $patron-&#62;currency;</code></a></h2>

<p>Returns the three character ISO 4217 currency code for the patron&#39;s preferred currency.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CHECKING_PATRON_PERMISSIONS"
>CHECKING PATRON PERMISSIONS</a></h1>

<p>Most of the methods associated with Patrons are related to checking if they&#39;re authorized to perform various actions:</p>

<pre>        $bool = $patron-E&#60;gt&#62;charge_ok;
        $bool = $patron-E&#60;gt&#62;renew_ok;
        $bool = $patron-E&#60;gt&#62;recall_ok;
        $bool = $patron-E&#60;gt&#62;hold_ok;
        $bool = $patron-E&#60;gt&#62;card_lost;
        $bool = $patron-E&#60;gt&#62;recall_overdue;
        $bool = $patron-E&#60;gt&#62;too_many_charged;
        $bool = $patron-E&#60;gt&#62;too_many_overdue;
        $bool = $patron-E&#60;gt&#62;too_many_renewal;
        $bool = $patron-E&#60;gt&#62;too_many_claim_return;
        $bool = $patron-E&#60;gt&#62;too_many_lost;
        $bool = $patron-E&#60;gt&#62;excessive_fines;
        $bool = $patron-E&#60;gt&#62;excessive_fees;
        $bool = $patron-E&#60;gt&#62;too_many_billed;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="LISTS_OF_ITEMS_ASSOCIATED_WITH_THE_USER"
>LISTS OF ITEMS ASSOCIATED WITH THE USER</a></h1>

<p>The <code>$patron</code> object provides a set of methods to find out information about various sets that are associated with the user. All these methods take two optional parameters: <code>$start</code> and <code>$end</code>, which define a subset of the list of items to be returned (<code>1</code> is the first item in the list). The following methods all return a reference to a list of <code>$item_id</code>s:</p>

<pre>        $items = $patron-E&#60;gt&#62;hold_items($start, $end);
        $items = $patron-E&#60;gt&#62;overdue_items($start, $end);
        $items = $patron-E&#60;gt&#62;charged_items($start, $end);
        $items = $patron-E&#60;gt&#62;recall_items($start, $end);
        $items = $patron-E&#60;gt&#62;unavail_holds($start, $end);</pre>

<p>It is also possible to retrieve an itemized list of the fines outstanding. This method returns a reference to an itemized list of fines:</p>

<pre>        $fines = $patron-E&#60;gt&#62;fine_items($start, $end);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PATRON_BORROWING_ACTIVITY"
>PATRON BORROWING ACTIVITY</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$num_=_$patron-&#62;fee_amount;"
><code>$num = $patron-&#62;fee_amount;</code></a></h2>

<p>The total amount of fees and fines owed by the patron.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$bool_=_$patron-&#62;drop_hold($item_id);"
><code>$bool = $patron-&#62;drop_hold($item_id);</code></a></h2>

<p>Drops the hold that <code>$patron</code> has placed on the item <code>$item_id</code>. Returns <code>false</code> if the patron did not have a hold on the item, <code>true</code> otherwise.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CHANGING_A_PATRON&#39;S_STATUS"
>CHANGING A PATRON&#39;S STATUS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$status_=_$ils-&#62;block($card_retained,_$blocked_card_msg);"
><code>$status = $ils-&#62;block($card_retained, $blocked_card_msg);</code></a></h2>

<p>Block the account of the patron identified by <code>$patron_id</code>. If the self check unit captured the patron&#39;s card, then <code>$card_retained</code> will be <code>true</code>. A message indicating why the card was retained will be provided by the parameter <code>$blocked_card_msg</code>.</p>

<p>This function returns an <code>ILS::Patron</code> object that has been updated to indicate that the patron&#39;s privileges have been blocked, or <code>undef</code> if the patron ID is not valid.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="$patron-&#62;enable;"
><code>$patron-&#62;enable;</code></a></h2>

<p>Reenable the patron after she&#39;s been blocked. This is a test function and will not normally be called by self-service terminals in production.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
