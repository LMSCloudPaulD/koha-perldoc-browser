<html><head><title>automatic_renewals.pl</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu Aug 29 12:07:22 2024 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#OPTIONS'>OPTIONS</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_ProcessRenewals'>_ProcessRenewals</a>
    <li class='indexItem indexItem2'><a href='#send_digests'>send_digests</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>automatic_renewals.pl - cron script to renew loans</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>./automatic_renewals.pl [-c|--confirm] [-s|--send-notices] [-d|--digest] [-b|--digest-per-branch] [-v|--verbose]</p>

<p>or,
in crontab: # Once every day for digest messages 0 3 * * * automatic_renewals.pl -c -d # Three times a day for non digest messages 0 0,8,16 * * * automatic_renewals.pl -c</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This script searches for issues scheduled for automatic renewal (issues.auto_renew).
If there are still renews left (Renewals allowed) and the renewal isn&#39;t premature (No Renewal before) the issue is renewed.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="OPTIONS"
>OPTIONS</a></h1>

<dl>
<dt><a name="-s|--send-notices"
><b>-s|--send-notices</b></a></dt>

<dd>
<p>DEPRECATED: The system preference AutoRenewalNotices should be used to determine whether notices are sent or not Send AUTO_RENEWALS notices to patrons if the auto renewal has been done.</p>

<dt><a name="-v|--verbose"
><b>-v|--verbose</b></a></dt>

<dd>
<p>Print report to standard out.</p>

<dt><a name="-c|--confirm"
><b>-c|--confirm</b></a></dt>

<dd>
<p>Without this parameter no changes will be made</p>

<dt><a name="-b|--digest-per-branch"
><b>-b|--digest-per-branch</b></a></dt>

<dd>
<p>Flag to indicate that generation of message digests should be performed separately for each branch.</p>

<p>A patron could potentially have loans at several different branches There is no natural branch to set as the sender on the aggregated message in this situation so the default behavior is to use the borrowers home branch.
This could surprise to the borrower when message sender is a library where they have not borrowed anything.</p>

<p>Enabling this flag ensures that the issuing library is the sender of the digested message.
It has no effect unless the borrower has chosen &#39;Digests only&#39; on the advance messages.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_ProcessRenewals"
>_ProcessRenewals</a></h2>

<pre>    Internal method to process the queue in chunks</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="send_digests"
>send_digests</a></h2>

<pre>    send_digests({
        digests =&#62; ...,
        letter_code =&#62; ...,
    })</pre>

<p>Enqueue digested letters.</p>

<p>Parameters:</p>

<dl>
<dt><a name="$digests"
><code>$digests</code></a></dt>

<dd>
<p>Reference to the array of digested messages.</p>

<dt><a name="$letter_code"
><code>$letter_code</code></a></dt>

<dd>
<p>String that denote the letter code.</p>
</dd>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
