<html><head><title>Koha::Patron</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Sun Oct 27 06:06:31 2024 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#API'>API</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Class_Methods'>Class Methods</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#search_limited'>search_limited</a>
      <li class='indexItem indexItem3'><a href='#search_housebound_choosers'>search_housebound_choosers</a>
      <li class='indexItem indexItem3'><a href='#search_housebound_deliverers'>search_housebound_deliverers</a>
      <li class='indexItem indexItem3'><a href='#search_upcoming_membership_expires'>search_upcoming_membership_expires</a>
      <li class='indexItem indexItem3'><a href='#search_patrons_to_anonymise'>search_patrons_to_anonymise</a>
      <li class='indexItem indexItem3'><a href='#delete'>delete</a>
      <li class='indexItem indexItem3'><a href='#filter_by_expiration_date'>filter_by_expiration_date</a>
      <li class='indexItem indexItem3'><a href='#search_unsubscribed'>search_unsubscribed</a>
      <li class='indexItem indexItem3'><a href='#search_anonymize_candidates'>search_anonymize_candidates</a>
      <li class='indexItem indexItem3'><a href='#search_anonymized'>search_anonymized</a>
      <li class='indexItem indexItem3'><a href='#lock'>lock</a>
      <li class='indexItem indexItem3'><a href='#anonymize'>anonymize</a>
      <li class='indexItem indexItem3'><a href='#search_patrons_to_update_category'>search_patrons_to_update_category</a>
      <li class='indexItem indexItem3'><a href='#update_category_to'>update_category_to</a>
      <li class='indexItem indexItem3'><a href='#filter_by_attribute_type'>filter_by_attribute_type</a>
      <li class='indexItem indexItem3'><a href='#filter_by_attribute_value'>filter_by_attribute_value</a>
      <li class='indexItem indexItem3'><a href='#filter_by_amount_owed'>filter_by_amount_owed</a>
      <ul   class='indexList indexList4'>
        <li class='indexItem indexItem4'><a href='#arguments_hashref'>arguments hashref</a>
      </ul>
      <li class='indexItem indexItem3'><a href='#filter_by_have_permission'>filter_by_have_permission</a>
      <li class='indexItem indexItem3'><a href='#filter_by_expired_opac_registrations'>filter_by_expired_opac_registrations</a>
      <li class='indexItem indexItem3'><a href='#filter_by_safe_to_delete'>filter_by_safe_to_delete</a>
      <li class='indexItem indexItem3'><a href='#extended_attributes_config'>extended_attributes_config</a>
      <li class='indexItem indexItem3'><a href='#_type'>_type</a>
      <li class='indexItem indexItem3'><a href='#object_class'>object_class</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Patron - Koha Patron Object class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="API"
>API</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Class_Methods"
>Class Methods</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_limited"
>search_limited</a></h3>

<p>my $patrons = Koha::Patrons-&#62;search_limit( $params,
$attributes );</p>

<p>Returns all the patrons the logged in user is allowed to see</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_housebound_choosers"
>search_housebound_choosers</a></h3>

<p>Returns all Patrons which are Housebound choosers.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_housebound_deliverers"
>search_housebound_deliverers</a></h3>

<p>Returns all Patrons which are Housebound deliverers.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_upcoming_membership_expires"
>search_upcoming_membership_expires</a></h3>

<p>my $patrons = Koha::Patrons-&#62;search_upcoming_membership_expires();</p>

<p>The &#39;before&#39; and &#39;after&#39; represent the number of days before/after the date that is set by the preference MembershipExpiryDaysNotice.
If the pref is 14,
before 2 and after 3 then you will get all expires from 12 to 17 days.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_patrons_to_anonymise"
>search_patrons_to_anonymise</a></h3>

<pre>    my $patrons = Koha::Patrons-&#62;search_patrons_to_anonymise( { before =&#62; $older_than_date, [ library =&#62; $library ] } );</pre>

<p>This method returns all patrons who has an issue history older than a given date.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="delete"
>delete</a></h3>

<pre>    Koha::Patrons-&#62;search({ some filters here })-&#62;delete({ move =&#62; 1 });

    Delete passed set of patron objects.
    Wrapper for Koha::Patron-&#62;delete. (We do not want to bypass Koha::Patron
    and let DBIx do the job without further housekeeping.)
    Includes a move to deletedborrowers if move flag set.

    Just like DBIx, the delete will only succeed when all entries could be
    deleted. Returns true or throws an exception.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_expiration_date"
>filter_by_expiration_date</a></h3>

<pre>    Koha::Patrons-&#62;filter_by_expiration_date{{ days =&#62; $x });

    Returns set of Koha patron objects expired $x days.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_unsubscribed"
>search_unsubscribed</a></h3>

<pre>    Koha::Patrons-&#62;search_unsubscribed;

    Returns a set of Koha patron objects for patrons that recently
    unsubscribed and are not locked (candidates for locking).
    Depends on UnsubscribeReflectionDelay.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_anonymize_candidates"
>search_anonymize_candidates</a></h3>

<pre>    Koha::Patrons-&#62;search_anonymize_candidates({ locked =&#62; 1 });

    Returns a set of Koha patron objects for patrons whose account is expired
    and locked (if parameter set). These are candidates for anonymizing.
    Depends on PatronAnonymizeDelay.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_anonymized"
>search_anonymized</a></h3>

<pre>    Koha::Patrons-&#62;search_anonymized;

    Returns a set of Koha patron objects for patron accounts that have been
    anonymized before and could be removed.
    Depends on PatronRemovalDelay.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="lock"
>lock</a></h3>

<pre>    Koha::Patrons-&#62;search({ some filters })-&#62;lock({ expire =&#62; 1, remove =&#62; 1 })

    Lock the passed set of patron objects. Optionally expire and remove holds.
    Wrapper around Koha::Patron-&#62;lock.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="anonymize"
>anonymize</a></h3>

<pre>    Koha::Patrons-&#62;search({ some filters })-&#62;anonymize();

    Anonymize passed set of patron objects.
    Wrapper around Koha::Patron-&#62;anonymize.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="search_patrons_to_update_category"
>search_patrons_to_update_category</a></h3>

<pre>    my $patrons = Koha::Patrons-&#62;search_patrons_to_update_category( {
                      from          =&#62; $from_category,
                      fine_max      =&#62; $fine_max,
                      fine_min      =&#62; $fin_min,
                      too_young     =&#62; $too_young,
                      too_old      =&#62; $too_old,
                  });</pre>

<p>This method returns all patron who should be updated from one category to another meeting criteria:</p>

<p>from - borrower categorycode fine_min - with fines totaling at least this amount fine_max - with fines above this amount too_young - if passed, select patrons who are under the age limit for the current category too_old - if passed, select patrons who are over the age limit for the current category</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="update_category_to"
>update_category_to</a></h3>

<pre>    Koha::Patrons-&#62;search-&#62;update_category_to( {
            category   =&#62; $to_category,
        });</pre>

<p>Update supplied patrons from current category to another and take care of guarantor info. To make sure all the conditions are met, the caller has the responsibility to call search_patrons_to_update to filter the Koha::Patrons set</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_attribute_type"
>filter_by_attribute_type</a></h3>

<p>my $patrons = Koha::Patrons-&#62;filter_by_attribute_type($attribute_type_code);</p>

<p>Return a Koha::Patrons set with patrons having the attribute defined.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_attribute_value"
>filter_by_attribute_value</a></h3>

<p>my $patrons = Koha::Patrons-&#62;filter_by_attribute_value($attribute_value);</p>

<p>Return a Koha::Patrons set with patrong having the attribute value passed in parameter.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_amount_owed"
>filter_by_amount_owed</a></h3>

<pre>    Koha::Patrons-&#62;filter_by_amount_owed(
        {
            less_than  =&#62; &#39;2.00&#39;,
            more_than  =&#62; &#39;0.50&#39;,
            debit_type =&#62; $debit_type_code,
            library    =&#62; $branchcode
        }
    );</pre>

<p>Returns patrons filtered by how much money they owe, between passed limits.</p>

<p>Optionally limit to debts of a particular debit_type or/and owed to a particular library.</p>

<h4><a class='u' href='#___top' title='click to go to top of document'
name="arguments_hashref"
>arguments hashref</a></h4>

<dl>
<dt><a name="less_than_(optional)_-_filter_out_patrons_who_owe_less_than_Amount"
>less_than (optional) - filter out patrons who owe less than Amount</a></dt>

<dd>
<dt><a name="more_than_(optional)_-_filter_out_patrons_who_owe_more_than_Amount"
>more_than (optional) - filter out patrons who owe more than Amount</a></dt>

<dd>
<dt><a name="debit_type_(optional)_-_filter_the_amount_owed_by_debit_type"
>debit_type (optional) - filter the amount owed by debit type</a></dt>

<dd>
<dt><a name="library_(optional)_-_filter_the_amount_owed_to_a_particular_branch"
>library (optional) - filter the amount owed to a particular branch</a></dt>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_have_permission"
>filter_by_have_permission</a></h3>

<pre>    my $patrons = Koha::Patrons-&#62;search-&#62;filter_by_have_permission(&#39;suggestions.suggestions_manage&#39;);

    my $patrons = Koha::Patrons-&#62;search-&#62;filter_by_have_permission(&#39;suggestions&#39;);</pre>

<p>Filter patrons who have a given subpermission or the whole permission.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_expired_opac_registrations"
>filter_by_expired_opac_registrations</a></h3>

<pre>    my $expired_registrations = $patrons-&#62;filter_by_expired_opac_registrations;</pre>

<p>Return patrons that have not upgraded from the &#39;temporary&#39; category</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="filter_by_safe_to_delete"
>filter_by_safe_to_delete</a></h3>

<pre>    my $safe_to_delete_patrons = $patrons-&#62;filter_by_safe_to_delete;</pre>

<p>Return the patrons that are safe to delete</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="extended_attributes_config"
>extended_attributes_config</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_type"
>_type</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="object_class"
>object_class</a></h3>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Kyle M Hall &#60;kyle@bywatersolutions.com&#62;</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
