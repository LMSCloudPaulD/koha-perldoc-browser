<html><head><title>Koha::CirculationRules</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu Nov 21 12:08:23 2024 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#API'>API</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Class_Methods'>Class Methods</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#rule_kinds'>rule_kinds</a>
      <li class='indexItem indexItem3'><a href='#get_effective_rule'>get_effective_rule</a>
      <li class='indexItem indexItem3'><a href='#get_effective_rule_value'>get_effective_rule_value</a>
      <li class='indexItem indexItem3'><a href='#get_effective_rules'>get_effective_rules</a>
      <li class='indexItem indexItem3'><a href='#set_rule'>set_rule</a>
      <li class='indexItem indexItem3'><a href='#set_rules'>set_rules</a>
      <li class='indexItem indexItem3'><a href='#delete'>delete</a>
      <li class='indexItem indexItem3'><a href='#clone'>clone</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#get_return_branch_policy'>get_return_branch_policy</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#get_opacitemholds_policy'>get_opacitemholds_policy</a>
      <li class='indexItem indexItem3'><a href='#get_onshelfholds_policy'>get_onshelfholds_policy</a>
      <li class='indexItem indexItem3'><a href='#get_lostreturn_policy'>get_lostreturn_policy</a>
      <li class='indexItem indexItem3'><a href='#article_requestable_rules'>article_requestable_rules</a>
      <li class='indexItem indexItem3'><a href='#guess_article_requestable_itemtypes'>guess_article_requestable_itemtypes</a>
      <li class='indexItem indexItem3'><a href='#get_effective_daysmode'>get_effective_daysmode</a>
      <li class='indexItem indexItem3'><a href='#type'>type</a>
      <li class='indexItem indexItem3'><a href='#object_class'>object_class</a>
    </ul>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::CirculationRules - Koha CirculationRule Object set class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="API"
>API</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Class_Methods"
>Class Methods</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="rule_kinds"
>rule_kinds</a></h3>

<p>This structure describes the possible rules that may be set,
and what scopes they can be set at.</p>

<p>Any attempt to set a rule with a nonsensical scope (for instance,
setting the <code>patron_maxissueqty</code> for a branchcode and itemtype),
is an error.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_effective_rule"
>get_effective_rule</a></h3>

<pre>  my $effective_rule = Koha::CirculationRules-&#62;get_effective_rule(
    {
        rule_name    =&#62; $name,
        categorycode =&#62; $categorycode,
        itemtype     =&#62; $itemtype,
        branchcode   =&#62; $branchcode
    }
  );</pre>

<p>Return the effective rule object for the rule associated with the criteria passed.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_effective_rule_value"
>get_effective_rule_value</a></h3>

<pre>  my $effective_rule_value = Koha::CirculationRules-&#62;get_effective_rule_value(
    {
        rule_name    =&#62; $name,
        categorycode =&#62; $categorycode,
        itemtype     =&#62; $itemtype,
        branchcode   =&#62; $branchcode
    }
  );</pre>

<p>Return the effective value for the rule associated with the criteria passed.</p>

<p>This is a cached method so should be used in preference to get_effective_rule where possible to aid performance.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_effective_rules"
>get_effective_rules</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="set_rule"
>set_rule</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="set_rules"
>set_rules</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="delete"
>delete</a></h3>

<p>Delete a set of circulation rules, needed for cleaning up when deleting issuingrules</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="clone"
>clone</a></h3>

<p>Clone a set of circulation rules to another branch</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_return_branch_policy"
>get_return_branch_policy</a></h2>

<pre>  my $returnbranch = Koha::CirculationRules-&#62;get_return_branch_policy($item);</pre>

<p>Returns the branch to use for returning the item based on the item type, and a branch selected via CircControlReturnsBranch.</p>

<p>The return value is the branch to which to return the item. Possible values: noreturn: do not return, let item remain where checked in (floating collections) homebranch: return to item&#39;s home branch holdingbranch: return to issuer branch</p>

<p>This searches branchitemrules in the following order: * Same branchcode and itemtype * Same branchcode, itemtype &#39;*&#39; * branchcode &#39;*&#39;, same itemtype * branchcode &#39;*&#39; and itemtype &#39;*&#39;</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_opacitemholds_policy"
>get_opacitemholds_policy</a></h3>

<p>my $can_place_a_hold_at_item_level = Koha::CirculationRules-&#62;get_opacitemholds_policy( { patron =&#62; $patron, item =&#62; $item } );</p>

<p>Return &#39;Y&#39; or &#39;F&#39; if the patron can place a hold on this item according to the issuing rules and the &#34;Item level holds&#34; (opacitemholds). Can be &#39;N&#39; - Don&#39;t allow, &#39;Y&#39; - Allow, and &#39;F&#39; - Force</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_onshelfholds_policy"
>get_onshelfholds_policy</a></h3>

<pre>    my $on_shelf_holds = Koha::CirculationRules-&#62;get_onshelfholds_policy({ item =&#62; $item, patron =&#62; $patron });</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_lostreturn_policy"
>get_lostreturn_policy</a></h3>

<pre>  my $lost_proc_refund_policy = Koha::CirculationRules-&#62;get_lostreturn_policy( { return_branch =&#62; $return_branch, item =&#62; $item } );</pre>

<p>lostreturn return values are:</p>

<dl>
<dt><a name="&#39;0&#39;_-_Do_not_refund"
>&#39;0&#39; - Do not refund</a></dt>

<dd>
<dt><a name="&#39;refund&#39;_-_Refund_the_lost_item_charge"
>&#39;refund&#39; - Refund the lost item charge</a></dt>

<dd>
<dt><a name="&#39;restore&#39;_-_Refund_the_lost_item_charge_and_restore_the_original_overdue_fine"
>&#39;restore&#39; - Refund the lost item charge and restore the original overdue fine</a></dt>

<dd>
<dt><a name="&#39;charge&#39;_-_Refund_the_lost_item_charge_and_charge_a_new_overdue_fine"
>&#39;charge&#39; - Refund the lost item charge and charge a new overdue fine</a></dt>
</dl>

<p>processing return return values are:</p>

<dl>
<dt><a name="&#39;0&#39;_-_Do_not_refund"
>&#39;0&#39; - Do not refund</a></dt>

<dd>
<dt><a name="&#39;refund&#39;_-_Refund_the_lost_item_processing_charge"
>&#39;refund&#39; - Refund the lost item processing charge</a></dt>

<dd>
<dt><a name="&#39;restore&#39;_-_Refund_the_lost_item_processing_charge_and_restore_the_original_overdue_fine"
>&#39;restore&#39; - Refund the lost item processing charge and restore the original overdue fine</a></dt>

<dd>
<dt><a name="&#39;charge&#39;_-_Refund_the_lost_item_processing_charge_and_charge_a_new_overdue_fine"
>&#39;charge&#39; - Refund the lost item processing charge and charge a new overdue fine</a></dt>
</dl>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="article_requestable_rules"
>article_requestable_rules</a></h3>

<pre>    Return rules that allow article requests, optionally filtered by
    patron categorycode.

    Use with care; see guess_article_requestable_itemtypes.</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="guess_article_requestable_itemtypes"
>guess_article_requestable_itemtypes</a></h3>

<pre>    Return item types in a hashref that are likely possible to be
    &#39;article requested&#39;. Constructed by an intelligent guess in the
    issuing rules (see article_requestable_rules).

    Note: pref ArticleRequestsLinkControl overrides the algorithm.

    Optional parameters: categorycode.

    Note: the routine is used in opac-search to obtain a reasonable
    estimate within performance borders (not looking at all items but
    just using default itemtype). Also we are not looking at the
    branchcode here, since home or holding branch of the item is
    leading and branch may be unknown too (anonymous opac session).</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_effective_daysmode"
>get_effective_daysmode</a></h3>

<p>Return the value for daysmode defined in the circulation rules. If not defined (or empty string), the value of the system preference useDaysMode is returned</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="type"
>type</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="object_class"
>object_class</a></h3>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
