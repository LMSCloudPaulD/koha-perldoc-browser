<html><head><title>C4::Members</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu Jun 22 12:12:54 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#patronflags'>patronflags</a>
    <li class='indexItem indexItem2'><a href='#GetAllIssues'>GetAllIssues</a>
    <li class='indexItem indexItem2'><a href='#get_cardnumber_length'>get_cardnumber_length</a>
    <li class='indexItem indexItem2'><a href='#GetBorrowersToExpunge'>GetBorrowersToExpunge</a>
    <li class='indexItem indexItem2'><a href='#IssueSlip'>IssueSlip</a>
    <li class='indexItem indexItem2'><a href='#DeleteExpiredOpacRegistrations'>DeleteExpiredOpacRegistrations</a>
    <li class='indexItem indexItem2'><a href='#DeleteUnverifiedOpacRegistrations'>DeleteUnverifiedOpacRegistrations</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>C4::Members - Perl Module containing convenience functions for member handling</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>use C4::Members;</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module contains routines for adding,
modifying and deleting members/patrons/borrowers</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="patronflags"
>patronflags</a></h2>

<pre> $flags = &#38;patronflags($patron);</pre>

<p>This function is not exported.</p>

<p>The following will be set where applicable: $flags-&#62;{CHARGES}-&#62;{amount} Amount of debt $flags-&#62;{CHARGES}-&#62;{noissues} Set if debt amount &#62;$5.00 (or syspref noissuescharge) $flags-&#62;{CHARGES}-&#62;{message} Message -- deprecated</p>

<pre> $flags-&#62;{CREDITS}-&#62;{amount}        Amount of credit
 $flags-&#62;{CREDITS}-&#62;{message}       Message -- deprecated

 $flags-&#62;{  GNA  }                  Patron has no valid address
 $flags-&#62;{  GNA  }-&#62;{noissues}      Set for each GNA
 $flags-&#62;{  GNA  }-&#62;{message}       &#34;Borrower has no valid address&#34; -- deprecated

 $flags-&#62;{ LOST  }                  Patron&#39;s card reported lost
 $flags-&#62;{ LOST  }-&#62;{noissues}      Set for each LOST
 $flags-&#62;{ LOST  }-&#62;{message}       Message -- deprecated

 $flags-&#62;{DBARRED}                  Set if patron debarred, no access
 $flags-&#62;{DBARRED}-&#62;{noissues}      Set for each DBARRED
 $flags-&#62;{DBARRED}-&#62;{message}       Message -- deprecated

 $flags-&#62;{ NOTES }
 $flags-&#62;{ NOTES }-&#62;{message}       The note itself.  NOT deprecated

 $flags-&#62;{ ODUES }                  Set if patron has overdue books.
 $flags-&#62;{ ODUES }-&#62;{message}       &#34;Yes&#34;  -- deprecated
 $flags-&#62;{ ODUES }-&#62;{itemlist}      ref-to-array: list of overdue books
 $flags-&#62;{ ODUES }-&#62;{itemlisttext}  Text list of overdue items -- deprecated

 $flags-&#62;{WAITING}                  Set if any of patron&#39;s reserves are available
 $flags-&#62;{WAITING}-&#62;{message}       Message -- deprecated
 $flags-&#62;{WAITING}-&#62;{itemlist}      ref-to-array: list of available items</pre>

<dl>
<dt><a 
><code>$flags-&#62;{ODUES}-&#62;{itemlist}</code> is a reference-to-array listing the overdue items. Its elements are references-to-hash, each describing an overdue item. The keys are selected fields from the issues, biblio, biblioitems, and items tables of the Koha database.</a></dt>

<dd>
<dt><a name="$flags-&#62;{ODUES}-&#62;{itemlisttext}_is_a_string_giving_a_text_listing_of_the_overdue_items,_one_per_line._Deprecated."
><code>$flags-&#62;{ODUES}-&#62;{itemlisttext}</code> is a string giving a text listing of the overdue items, one per line. Deprecated.</a></dt>

<dd>
<dt><a 
><code>$flags-&#62;{WAITING}-&#62;{itemlist}</code> is a reference-to-array listing the available items. Each element is a reference-to-hash whose keys are fields from the reserves table of the Koha database.</a></dt>
</dl>

<p>All the &#34;message&#34; fields that include language generated in this function are deprecated, because such strings belong properly in the display layer.</p>

<p>The &#34;message&#34; field that comes from the DB is OK.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAllIssues"
>GetAllIssues</a></h2>

<pre>  $issues = &#38;GetAllIssues($borrowernumber, $sortkey, $limit);</pre>

<p>Looks up what the patron with the given borrowernumber has borrowed, and sorts the results.</p>

<p><code>$sortkey</code> is the name of a field on which to sort the results. This should be the name of a field in the <code>issues</code>, <code>biblio</code>, <code>biblioitems</code>, or <code>items</code> table in the Koha database.</p>

<p><code>$limit</code> is the maximum number of results to return.</p>

<p><code>&#38;GetAllIssues</code> an arrayref, <code>$issues</code>, of hashrefs, the keys of which are the fields from the <code>issues</code>, <code>biblio</code>, <code>biblioitems</code>, and <code>items</code> tables of the Koha database.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_cardnumber_length"
>get_cardnumber_length</a></h2>

<pre>    my ($min, $max) = C4::Members::get_cardnumber_length()</pre>

<p>Returns the minimum and maximum length for patron cardnumbers as determined by the CardnumberLength system preference, the BorrowerMandatoryField system preference, and the width of the database column.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetBorrowersToExpunge"
>GetBorrowersToExpunge</a></h2>

<pre>  $borrowers = &#38;GetBorrowersToExpunge(
      not_borrowed_since =&#62; $not_borrowed_since,
      expired_before       =&#62; $expired_before,
      category_code        =&#62; \@category_code,
      patron_list_id       =&#62; $patron_list_id,
      branchcode           =&#62; $branchcode
  );

  This function get all borrowers based on the given criteria.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="IssueSlip"
>IssueSlip</a></h2>

<pre>  IssueSlip($branchcode, $borrowernumber, $quickslip)

  Returns letter hash ( see C4::Letters::GetPreparedLetter )

  $quickslip is boolean, to indicate whether we want a quick slip

  IssueSlip populates ISSUESLIP and ISSUEQSLIP, and will make the following expansions:

  Both slips:

      &#60;&#60;branches.*&#62;&#62;
      &#60;&#60;borrowers.*&#62;&#62;

  ISSUESLIP:

      &#60;checkedout&#62;
         &#60;&#60;biblio.*&#62;&#62;
         &#60;&#60;items.*&#62;&#62;
         &#60;&#60;biblioitems.*&#62;&#62;
         &#60;&#60;issues.*&#62;&#62;
      &#60;/checkedout&#62;

      &#60;overdue&#62;
         &#60;&#60;biblio.*&#62;&#62;
         &#60;&#60;items.*&#62;&#62;
         &#60;&#60;biblioitems.*&#62;&#62;
         &#60;&#60;issues.*&#62;&#62;
      &#60;/overdue&#62;

      &#60;news&#62;
         &#60;&#60;additional_contents.*&#62;&#62;
      &#60;/news&#62;

  ISSUEQSLIP:

      &#60;checkedout&#62;
         &#60;&#60;biblio.*&#62;&#62;
         &#60;&#60;items.*&#62;&#62;
         &#60;&#60;biblioitems.*&#62;&#62;
         &#60;&#60;issues.*&#62;&#62;
      &#60;/checkedout&#62;

  NOTE: Fields from tables issues, items, biblio and biblioitems are available</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DeleteExpiredOpacRegistrations"
>DeleteExpiredOpacRegistrations</a></h2>

<pre>    Delete accounts that haven&#39;t been upgraded from the &#39;temporary&#39; category
    Returns the number of removed patrons</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DeleteUnverifiedOpacRegistrations"
>DeleteUnverifiedOpacRegistrations</a></h2>

<pre>    Delete all unverified self registrations in borrower_modifications,
    older than the specified number of days.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Koha Team</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
