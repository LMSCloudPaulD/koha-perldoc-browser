<html><head><title>Koha::Edifact::Order</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Wed Apr 26 01:07:10 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#BUGS'>BUGS</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#filename'>filename</a>
    <li class='indexItem indexItem2'><a href='#encode'>encode</a>
    <li class='indexItem indexItem2'><a href='#initial_service_segments'>initial_service_segments</a>
    <li class='indexItem indexItem2'><a href='#interchange_header'>interchange_header</a>
    <li class='indexItem indexItem2'><a href='#user_data_message_segments'>user_data_message_segments</a>
    <li class='indexItem indexItem2'><a href='#message_trailer'>message_trailer</a>
    <li class='indexItem indexItem2'><a href='#trailing_service_segments'>trailing_service_segments</a>
    <li class='indexItem indexItem2'><a href='#interchange_control_reference'>interchange_control_reference</a>
    <li class='indexItem indexItem2'><a href='#message_reference'>message_reference</a>
    <li class='indexItem indexItem2'><a href='#message_header'>message_header</a>
    <li class='indexItem indexItem2'><a href='#interchange_trailer'>interchange_trailer</a>
    <li class='indexItem indexItem2'><a href='#order_msg_header'>order_msg_header</a>
    <li class='indexItem indexItem2'><a href='#beginning_of_message'>beginning_of_message</a>
    <li class='indexItem indexItem2'><a href='#name_and_address'>name_and_address</a>
    <li class='indexItem indexItem2'><a href='#order_line'>order_line</a>
    <li class='indexItem indexItem2'><a href='#item_description'>item_description</a>
    <li class='indexItem indexItem2'><a href='#imd_segment'>imd_segment</a>
    <li class='indexItem indexItem2'><a href='#gir_segments'>gir_segments</a>
    <li class='indexItem indexItem2'><a href='#add_gir_identity_number'>add_gir_identity_number</a>
    <li class='indexItem indexItem2'><a href='#add_seg'>add_seg</a>
    <li class='indexItem indexItem2'><a href='#lin_segment'>lin_segment</a>
    <li class='indexItem indexItem2'><a href='#additional_product_id'>additional_product_id</a>
    <li class='indexItem indexItem2'><a href='#message_date_segment'>message_date_segment</a>
    <li class='indexItem indexItem2'><a href='#_const'>_const</a>
    <li class='indexItem indexItem2'><a href='#_interchange_sr_identifier'>_interchange_sr_identifier</a>
    <li class='indexItem indexItem2'><a href='#encode_text'>encode_text</a>
    <li class='indexItem indexItem2'><a href='#msg_date_string'>msg_date_string</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
  <li class='indexItem indexItem1'><a href='#COPYRIGHT'>COPYRIGHT</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Edifact::Order</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>Format an Edifact Order message from a Koha basket</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Generates an Edifact format Order message for a Koha basket.
Normally the only methods used directly by the caller would be new to set up the message,
encode to return the formatted message and filename to obtain a name under which to store the message</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BUGS"
>BUGS</a></h1>

<p>Should integrate into Koha::Edifact namespace Can caller interface be made cleaner?
Make handling of GIR segments more customizable</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>  my $edi_order = Edifact::Order-&#62;new(
  orderlines =&#62; \@orderlines,
  vendor     =&#62; $vendor_edi_account,
  ean        =&#62; $library_ean
  );

  instantiate the Edifact::Order object, all parameters are Schema::Resultset objects
  Called in Koha::Edifact create_edi_order</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="filename"
>filename</a></h2>

<pre>   my $filename = $edi_order-&#62;filename()

   returns a filename for the edi order. The filename embeds a reference to the
   basket the message was created to encode</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="encode"
>encode</a></h2>

<pre>   my $edifact_message = $edi_order-&#62;encode();

   Encodes the basket as a valid edifact message ready for transmission</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="initial_service_segments"
>initial_service_segments</a></h2>

<pre>    Creates the service segments which begin the message</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="interchange_header"
>interchange_header</a></h2>

<pre>    Return an interchange header encoding sender and recipient
    ids message date and standards</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="user_data_message_segments"
>user_data_message_segments</a></h2>

<pre>    Include message data within the encoded message</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="message_trailer"
>message_trailer</a></h2>

<pre>    Terminate message data including control data on number
    of messages and segments included</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="trailing_service_segments"
>trailing_service_segments</a></h2>

<pre>   Include the service segments occurring at the end of the message</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="interchange_control_reference"
>interchange_control_reference</a></h2>

<pre>   Returns the unique interchange control reference as a 14 digit number</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="message_reference"
>message_reference</a></h2>

<pre>    On generates and subsequently returns the unique message
    reference number as a 12 digit number preceded by ME, to generate a new number
    pass the string &#39;new&#39;.
    In practice we encode 1 message per transmission so there is only one message
    referenced. were we to encode multiple messages a new reference would be
    neaded for each</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="message_header"
>message_header</a></h2>

<pre>    Commences a new message</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="interchange_trailer"
>interchange_trailer</a></h2>

<pre>    returns the UNZ segment which ends the tranmission encoding the
    message count and control reference for the interchange</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="order_msg_header"
>order_msg_header</a></h2>

<pre>    Formats the message header segments</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="beginning_of_message"
>beginning_of_message</a></h2>

<pre>    Returns the BGM segment which includes the Koha basket number</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="name_and_address"
>name_and_address</a></h2>

<pre>    Parameters: Function ( BUYER, DELIVERY, INVOICE, SUPPLIER)
                Id
                Agency

    Returns a NAD segment containg the id and agency for for the Function
    value. Handles the fact that NAD segments encode the value for &#39;EAN&#39; differently
    to elsewhere.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="order_line"
>order_line</a></h2>

<pre>    Creates the message segments wncoding an order line</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="item_description"
>item_description</a></h2>

<pre>    Encodes the biblio item fields Author, title, publisher, date of publication
    binding</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="imd_segment"
>imd_segment</a></h2>

<pre>    Formats an IMD segment, handles the chunking of data into the 35 character
    lengths required and the creation of repeat segments</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="gir_segments"
>gir_segments</a></h2>

<pre>    Add item level information</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="add_gir_identity_number"
>add_gir_identity_number</a></h2>

<pre>    Handle the formatting of a GIR element
    return empty string if no data</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="add_seg"
>add_seg</a></h2>

<pre>    Adds a parssed array of segments to the objects segment list
    ensures all segments are properly terminated by &#39;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="lin_segment"
>lin_segment</a></h2>

<pre>    Adds a LIN segment consisting of the line number and the ean number
    if the passed isbn is valid</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="additional_product_id"
>additional_product_id</a></h2>

<pre>    Add a PIA segment for an additional product id</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="message_date_segment"
>message_date_segment</a></h2>

<pre>    Passed a DateTime object returns a correctly formatted DTM segment</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_const"
>_const</a></h2>

<pre>    Stores and returns constant strings for service_string_advice
    and message_identifier
    TBD replace with class variables</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_interchange_sr_identifier"
>_interchange_sr_identifier</a></h2>

<pre>    Format sender and receipient identifiers for use in the interchange header</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="encode_text"
>encode_text</a></h2>

<pre>    Encode textual data into the standard character set ( iso 8859-1 )
    and quote any Edifact metacharacters</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="msg_date_string"
>msg_date_string</a></h2>

<pre>    Convenient routine which returns message date as a Y-m-d string
    useful if the caller wants to log date of creation</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<pre>   Colin Campbell &#60;colin.campbell@ptfs-europe.com&#62;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="COPYRIGHT"
>COPYRIGHT</a></h1>

<pre>   Copyright 2014,2015,2016 PTFS-Europe Ltd
   This program is free software, You may redistribute it under
   under the terms of the GNU General Public License</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
