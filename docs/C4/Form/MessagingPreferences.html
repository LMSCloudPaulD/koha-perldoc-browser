<html><head><title>C4::Form::MessagingPreferences</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu Apr 13 18:17:53 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#handle_form_action'>handle_form_action</a>
    <li class='indexItem indexItem2'><a href='#set_form_values'>set_form_values</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#TODO'>TODO</a>
  <li class='indexItem indexItem1'><a href='#SEE_ALSO'>SEE ALSO</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>C4::Form::MessagingPreferences - manage messaging preferences form</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>In script:</p>

<pre>    use C4::Form::MessagingPreferences;
    C4::Form::MessagingPreferences::set_form_value({ borrowernumber =&#62; 51 }, $template);
    C4::Form::MessagingPreferences::handle_form_action($input, { categorycode =&#62; &#39;CPL&#39; }, $template);</pre>

<p>In HTML template:</p>

<pre>    &#60;!-- TMPL_INCLUDE NAME=&#34;messaging-preference-form.inc&#34; --&#62;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This module manages input and output for the messaging preferences form that is used in the staff patron editor, the staff patron category editor, and the OPAC patron messaging prefereneces form. It in its current form, it essentially serves only to eliminate copy-and-paste code, but suggests at least one approach for reconciling functionality that does mostly the same thing in staff and OPAC.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="handle_form_action"
>handle_form_action</a></h2>

<pre>    C4::Form::MessagingPreferences::handle_form_action($input, { categorycode =&#62; &#39;CPL&#39; }, $template, $insert);</pre>

<p>Processes CGI parameters and updates the target patron or patron category&#39;s preferences.</p>

<p><code>$input</code> is the CGI query object.</p>

<p><code>$target_params</code> is a hashref containing either a <code>categorycode</code> key or a <code>borrowernumber</code> key identifying the patron or patron category whose messaging preferences are to be updated.</p>

<p><code>$template</code> is the Template::Toolkit object for the response; this routine adds a settings_updated template variable.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_form_values"
>set_form_values</a></h2>

<pre>    C4::Form::MessagingPreferences::set_form_value({ borrowernumber =&#62; 51 }, $template);</pre>

<p>Retrieves the messaging preferences for the specified patron or patron category and fills the corresponding template variables.</p>

<p><code>$target_params</code> is a hashref containing either a <code>categorycode</code> key or a <code>borrowernumber</code> key identifying the patron or patron category.</p>

<p><code>$template</code> is the Template::Toolkit object for the response.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TODO"
>TODO</a></h1>

<dl>
<dt><a name="Reduce_coupling_between_processing_CGI_parameters_and_updating_the_messaging_preferences"
>Reduce coupling between processing CGI parameters and updating the messaging preferences</a></dt>

<dd>
<dt><a name="Handle_when_form_input_is_invalid"
>Handle when form input is invalid</a></dt>

<dd>
<dt><a name="Generalize_into_a_system_of_form_handler_clases"
>Generalize into a system of form handler clases</a></dt>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SEE_ALSO"
>SEE ALSO</a></h1>

<p><a href="../../C4/Members/Messaging.html" class="podlinkpod"
>C4::Members::Messaging</a>, <em>admin/categories.pl</em>, <em>opac/opac-messaging.pl</em>, <em>members/messaging.pl</em></p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Koha Development Team &#60;http://koha-community.org/&#62;</p>

<p>Galen Charlton &#60;galen.charlton@liblime.com&#62; refactoring code by Andrew Moore.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
