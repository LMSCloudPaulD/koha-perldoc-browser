<html><head><title>Koha::XSLT::Base</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Mon Feb 27 12:31:26 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#transform'>transform</a>
    <li class='indexItem indexItem2'><a href='#refresh'>refresh</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#PROPERTIES'>PROPERTIES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#err'>err</a>
    <li class='indexItem indexItem2'><a href='#do_not_return_source'>do_not_return_source</a>
    <li class='indexItem indexItem2'><a href='#print_warns'>print_warns</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#ERROR_CODES'>ERROR CODES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_NO_FILE'>Error XSLTH_ERR_NO_FILE</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_FILE_NOT_FOUND'>Error XSLTH_ERR_FILE_NOT_FOUND</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_LOADING'>Error XSLTH_ERR_LOADING</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_PARSING_CODE'>Error XSLTH_ERR_PARSING_CODE</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_PARSING_DATA'>Error XSLTH_ERR_PARSING_DATA</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_ERR_TRANSFORMING'>Error XSLTH_ERR_TRANSFORMING</a>
    <li class='indexItem indexItem2'><a href='#Error_XSLTH_NO_STRING_PASSED'>Error XSLTH_NO_STRING_PASSED</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNALS'>INTERNALS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#last_xsltfile'>last_xsltfile</a>
    <li class='indexItem indexItem2'><a href='#xslt_hash'>xslt_hash</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#ADDITIONAL_COMMENTS'>ADDITIONAL COMMENTS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#transform'>transform</a>
    <li class='indexItem indexItem2'><a href='#refresh'>refresh</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::XSLT::Base - Facilitate use of XSLT transformations</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Koha::XSLT::Base;
    my $xslt_engine = Koha::XSLT::Base-&#62;new;
    my $output = $xslt_engine-&#62;transform($xml, $xsltfilename);
    $output = $xslt_engine-&#62;transform({ xml =&#62; $xml, file =&#62; $file });
    $output = $xslt_engine-&#62;transform({ xml =&#62; $xml, code =&#62; $code });
    my $err= $xslt_engine-&#62;err; # error code
    $xslt_engine-&#62;refresh($xsltfilename);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<pre>    A XSLT handler object on top of LibXML and LibXSLT, allowing you to
    run XSLT stylesheets repeatedly without loading them again.
    Errors occurring during loading, parsing or transforming are reported
    via the err attribute.
    Reloading XSLT files can be done with the refresh method.

    The module refers to a (temporary) helper module Koha::XSLT::HTTPS that
    resolves issues in libxml2/libxslt for https references.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    Create handler object</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="transform"
>transform</a></h2>

<pre>    Run transformation for specific string and stylesheet</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="refresh"
>refresh</a></h2>

<pre>    Allow to reload stylesheets when transforming again</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PROPERTIES"
>PROPERTIES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="err"
>err</a></h2>

<pre>    Error code (see list of ERROR CODES)</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="do_not_return_source"
>do_not_return_source</a></h2>

<pre>    If true, transform returns undef on failure. By default, it returns the
    original string passed. Errors are reported as described.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="print_warns"
>print_warns</a></h2>

<pre>    If set, print error messages to STDERR. False by default.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ERROR_CODES"
>ERROR CODES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_NO_FILE"
>Error XSLTH_ERR_NO_FILE</a></h2>

<pre>    No XSLT file passed</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_FILE_NOT_FOUND"
>Error XSLTH_ERR_FILE_NOT_FOUND</a></h2>

<pre>    XSLT file not found</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_LOADING"
>Error XSLTH_ERR_LOADING</a></h2>

<pre>    Error while loading stylesheet xml: [optional warnings]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_PARSING_CODE"
>Error XSLTH_ERR_PARSING_CODE</a></h2>

<pre>    Error while parsing stylesheet: [optional warnings]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_PARSING_DATA"
>Error XSLTH_ERR_PARSING_DATA</a></h2>

<pre>    Error while parsing input: [optional warnings]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_ERR_TRANSFORMING"
>Error XSLTH_ERR_TRANSFORMING</a></h2>

<pre>    Error while transforming input: [optional warnings]</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Error_XSLTH_NO_STRING_PASSED"
>Error XSLTH_NO_STRING_PASSED</a></h2>

<pre>    No string to transform</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNALS"
>INTERNALS</a></h1>

<pre>    For documentation purposes. You are not encouraged to access them.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="last_xsltfile"
>last_xsltfile</a></h2>

<pre>    Contains the last successfully executed XSLT filename</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="xslt_hash"
>xslt_hash</a></h2>

<pre>    Hash reference to loaded stylesheets</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ADDITIONAL_COMMENTS"
>ADDITIONAL COMMENTS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    my $xslt_engine = Koha::XSLT::Base-&#62;new;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="transform"
>transform</a></h2>

<pre>    my $output= $xslt_engine-&#62;transform( $xml, $xsltfilename, [$format] );
    #Alternatively:
    #$output = $xslt_engine-&#62;transform({ xml =&#62; $xml, file =&#62; $file, [parameters =&#62; $parameters], [format =&#62; [&#39;chars&#39;|&#39;bytes&#39;|&#39;xmldoc&#39;]] });
    #$output = $xslt_engine-&#62;transform({ xml =&#62; $xml, code =&#62; $code, [parameters =&#62; $parameters], [format =&#62; [&#39;chars&#39;|&#39;bytes&#39;|&#39;xmldoc&#39;]] });
    if( $xslt_engine-&#62;err ) {
        #decide what to do on failure..
    }
    my $output2= $xslt_engine-&#62;transform( $xml2 );

    Pass a xml string and a fully qualified path of a XSLT file.
    Instead of a filename, you may also pass a URL.
    You may also pass the contents of a xsl file as a string like $code above.
    If you do not pass a filename, the last file used is assumed.
    Normally returns the transformed string; if you pass format =&#62; &#39;xmldoc&#39; in
    the hash format, it returns a xml document object.
    Check the error number in err to know if something went wrong.
    In that case do_not_return_source did determine the return value.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="refresh"
>refresh</a></h2>

<pre>    $xslt_engine-&#62;refresh;
    $xslt_engine-&#62;refresh( $xsltfilename );

    Pass a file for an individual refresh or no file to refresh all.
    Refresh returns the number of items affected.
    What we actually do, is just clear the internal cache for reloading next
    time when transform is called.
    The return value is mainly theoretical. Since this is supposed to work
    always(...), there is no actual need to test it.
    Note that refresh does also clear the error information.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<pre>    Marcel de Rooy, Rijksmuseum Netherlands
    David Cook, Prosentient Systems</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
