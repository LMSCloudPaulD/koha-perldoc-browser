<html><head><title>Koha::Database</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Mon Apr 10 18:18:07 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#dbh'>dbh</a>
    <li class='indexItem indexItem2'><a href='#schema'>schema</a>
    <li class='indexItem indexItem2'><a href='#new_schema'>new_schema</a>
    <li class='indexItem indexItem2'><a href='#set_schema'>set_schema</a>
    <li class='indexItem indexItem2'><a href='#restore_schema'>restore_schema</a>
    <li class='indexItem indexItem2'><a href='#get_schema_cached'>get_schema_cached</a>
    <li class='indexItem indexItem2'><a href='#flush_schema_cache'>flush_schema_cache</a>
    <li class='indexItem indexItem2'><a href='#db_scheme2dbi'>db_scheme2dbi</a>
    <li class='indexItem indexItem2'><a href='#EXPORT'>EXPORT</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Database</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use Koha::Database;
  my $schema = Koha::Database-&#62;schema();</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    $schema = Koha::Database-&#62;new-&#62;schema;

    FIXME: It is useless to have a Koha::Database object since all methods
    below act as class methods
    Koha::Database-&#62;new-&#62;schema is exactly the same as Koha::Database-&#62;schema
    We should use Koha::Database-&#62;schema everywhere and remove the `new` method</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="dbh"
>dbh</a></h2>

<pre>    Returns a database handler without loading the DBIx::Class schema.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="schema"
>schema</a></h2>

<pre>    $schema = Koha::Database-&#62;schema;
    $schema = Koha::Database-&#62;schema({ new =&#62; 1 });</pre>

<p>Returns a database handle connected to the Koha database for the current context. If no connection has yet been made, this method creates one, and connects to the database.</p>

<p>This database handle is cached for future use: if you call <code>$database-&#62;schema</code> twice, you will get the same handle both times. If you need a second database handle, use <code>&#38;new_schema</code> and possibly <code>&#38;set_schema</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new_schema"
>new_schema</a></h2>

<pre>  $schema = $database-&#62;new_schema;</pre>

<p>Creates a new connection to the Koha database for the current context, and returns the database handle (a <code>DBI::db</code> object).</p>

<p>The handle is not saved anywhere: this method is strictly a convenience function; the point is that it knows which database to connect to so that the caller doesn&#39;t have to know.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="set_schema"
>set_schema</a></h2>

<pre>  $my_schema = $database-&#62;new_schema;
  $database-&#62;set_schema($my_schema);
  ...
  $database-&#62;restore_schema;</pre>

<p><code>&#38;set_schema</code> and <code>&#38;restore_schema</code> work in a manner analogous to <code>&#38;set_context</code> and <code>&#38;restore_context</code>.</p>

<p><code>&#38;set_schema</code> saves the current database handle on a stack, then sets the current database handle to <code>$my_schema</code>.</p>

<p><code>$my_schema</code> is assumed to be a good database handle.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="restore_schema"
>restore_schema</a></h2>

<pre>  $database-&#62;restore_schema;</pre>

<p>Restores the database handle saved by an earlier call to <code>$database-&#62;set_schema</code>.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_schema_cached"
>get_schema_cached</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="flush_schema_cache"
>flush_schema_cache</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="db_scheme2dbi"
>db_scheme2dbi</a></h2>

<pre>    my $dbd_driver_name = Koha::Database::db_scheme2dbi($scheme);</pre>

<p>This routines translates a database type to part of the name of the appropriate DBD driver to use when establishing a new database connection. It recognizes &#39;mysql&#39; and &#39;Pg&#39;; if any other scheme is supplied it defaults to &#39;mysql&#39;.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="EXPORT"
>EXPORT</a></h2>

<p>None by default.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Chris Cormack, &#60;chrisc@catalyst.net.nz&#62;</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
