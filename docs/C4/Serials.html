<html><head><title>C4::Serials</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Tue Nov  7 12:10:45 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#SUBROUTINES'>SUBROUTINES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#GetSuppliersWithLateIssues'>GetSuppliersWithLateIssues</a>
    <li class='indexItem indexItem2'><a href='#GetSubscriptionHistoryFromSubscriptionId'>GetSubscriptionHistoryFromSubscriptionId</a>
    <li class='indexItem indexItem2'><a href='#GetSerialInformation'>GetSerialInformation</a>
    <li class='indexItem indexItem2'><a href='#AddItem2Serial'>AddItem2Serial</a>
    <li class='indexItem indexItem2'><a href='#GetSubscription'>GetSubscription</a>
    <li class='indexItem indexItem2'><a href='#GetFullSubscription'>GetFullSubscription</a>
    <li class='indexItem indexItem2'><a href='#PrepareSerialsData'>PrepareSerialsData</a>
    <li class='indexItem indexItem2'><a href='#GetSubscriptionsFromBiblionumber'>GetSubscriptionsFromBiblionumber</a>
    <li class='indexItem indexItem2'><a href='#GetFullSubscriptionsFromBiblionumber'>GetFullSubscriptionsFromBiblionumber</a>
    <li class='indexItem indexItem2'><a href='#SearchSubscriptions'>SearchSubscriptions</a>
    <li class='indexItem indexItem2'><a href='#GetSerials'>GetSerials</a>
    <li class='indexItem indexItem2'><a href='#GetSerials2'>GetSerials2</a>
    <li class='indexItem indexItem2'><a href='#GetLatestSerials'>GetLatestSerials</a>
    <li class='indexItem indexItem2'><a href='#GetPreviousSerialid'>GetPreviousSerialid</a>
    <li class='indexItem indexItem2'><a href='#GetNextSeq'>GetNextSeq</a>
    <li class='indexItem indexItem2'><a href='#GetSeq'>GetSeq</a>
    <li class='indexItem indexItem2'><a href='#GetExpirationDate'>GetExpirationDate</a>
    <li class='indexItem indexItem2'><a href='#CountSubscriptionFromBiblionumber'>CountSubscriptionFromBiblionumber</a>
    <li class='indexItem indexItem2'><a href='#ModSubscriptionHistory'>ModSubscriptionHistory</a>
    <li class='indexItem indexItem2'><a href='#ModSerialStatus'>ModSerialStatus</a>
    <li class='indexItem indexItem2'><a href='#GetNextExpected'>GetNextExpected</a>
    <li class='indexItem indexItem2'><a href='#ModNextExpected'>ModNextExpected</a>
    <li class='indexItem indexItem2'><a href='#GetSubscriptionIrregularities'>GetSubscriptionIrregularities</a>
    <li class='indexItem indexItem2'><a href='#ModSubscription'>ModSubscription</a>
    <li class='indexItem indexItem2'><a href='#NewSubscription'>NewSubscription</a>
    <li class='indexItem indexItem2'><a href='#GetSubscriptionLength'>GetSubscriptionLength</a>
    <li class='indexItem indexItem2'><a href='#ReNewSubscription'>ReNewSubscription</a>
    <li class='indexItem indexItem2'><a href='#NewIssue'>NewIssue</a>
    <li class='indexItem indexItem2'><a href='#HasSubscriptionStrictlyExpired'>HasSubscriptionStrictlyExpired</a>
    <li class='indexItem indexItem2'><a href='#HasSubscriptionExpired'>HasSubscriptionExpired</a>
    <li class='indexItem indexItem2'><a href='#DelSubscription'>DelSubscription</a>
    <li class='indexItem indexItem2'><a href='#DelIssue'>DelIssue</a>
    <li class='indexItem indexItem2'><a href='#GetLateOrMissingIssues'>GetLateOrMissingIssues</a>
    <li class='indexItem indexItem2'><a href='#updateClaim'>updateClaim</a>
    <li class='indexItem indexItem2'><a href='#check_routing'>check_routing</a>
    <li class='indexItem indexItem2'><a href='#addroutingmember'>addroutingmember</a>
    <li class='indexItem indexItem2'><a href='#reorder_members'>reorder_members</a>
    <li class='indexItem indexItem2'><a href='#delroutingmember'>delroutingmember</a>
    <li class='indexItem indexItem2'><a href='#getroutinglist'>getroutinglist</a>
    <li class='indexItem indexItem2'><a href='#countissuesfrom'>countissuesfrom</a>
    <li class='indexItem indexItem2'><a href='#CountIssues'>CountIssues</a>
    <li class='indexItem indexItem2'><a href='#HasItems'>HasItems</a>
    <li class='indexItem indexItem2'><a href='#abouttoexpire'>abouttoexpire</a>
    <li class='indexItem indexItem2'><a href='#GetFictiveIssueNumber'>GetFictiveIssueNumber</a>
    <li class='indexItem indexItem2'><a href='#GetNextDate'>GetNextDate</a>
    <li class='indexItem indexItem2'><a href='#_numeration'>_numeration</a>
    <li class='indexItem indexItem2'><a href='#CloseSubscription'>CloseSubscription</a>
    <li class='indexItem indexItem2'><a href='#ReopenSubscription'>ReopenSubscription</a>
    <li class='indexItem indexItem2'><a href='#subscriptionCurrentlyOnOrder'>subscriptionCurrentlyOnOrder</a>
    <li class='indexItem indexItem2'><a href='#can_claim_subscription'>can_claim_subscription</a>
    <li class='indexItem indexItem2'><a href='#can_edit_subscription'>can_edit_subscription</a>
    <li class='indexItem indexItem2'><a href='#can_show_subscription'>can_show_subscription</a>
    <li class='indexItem indexItem2'><a href='#findSerialsByStatus'>findSerialsByStatus</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>C4::Serials - Serials Module Functions</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>  use C4::Serials;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Functions for handling subscriptions, claims routing etc.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SUBROUTINES"
>SUBROUTINES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSuppliersWithLateIssues"
>GetSuppliersWithLateIssues</a></h2>

<p>$supplierlist = GetSuppliersWithLateIssues()</p>

<p>this function get all suppliers with late issues.</p>

<p>return : an array_ref of suppliers each entry is a hash_ref containing id and name the array is in name order</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSubscriptionHistoryFromSubscriptionId"
>GetSubscriptionHistoryFromSubscriptionId</a></h2>

<p>$history = GetSubscriptionHistoryFromSubscriptionId($subscriptionid);</p>

<p>This function returns the subscription history as a hashref</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSerialInformation"
>GetSerialInformation</a></h2>

<p>$data = GetSerialInformation($serialid); returns a hash_ref containing : items : items marcrecord (can be an array) serial table field subscription table field + information about subscription expiration</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AddItem2Serial"
>AddItem2Serial</a></h2>

<p>$rows = AddItem2Serial($serialid,$itemnumber); Adds an itemnumber to Serial record returns the number of rows affected</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSubscription"
>GetSubscription</a></h2>

<p>$subs = GetSubscription($subscriptionid) this function returns the subscription which has $subscriptionid as id. return : a hashref. This hash contains subscription, subscriptionhistory, aqbooksellers.name, biblio.title</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetFullSubscription"
>GetFullSubscription</a></h2>

<pre>   $array_ref = GetFullSubscription($subscriptionid)
   this function reads the serial table.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="PrepareSerialsData"
>PrepareSerialsData</a></h2>

<pre>   $array_ref = PrepareSerialsData($serialinfomation)
   where serialinformation is a hashref array</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSubscriptionsFromBiblionumber"
>GetSubscriptionsFromBiblionumber</a></h2>

<p>$array_ref = GetSubscriptionsFromBiblionumber($biblionumber) this function get the subscription list. it reads the subscription table. return : reference to an array of subscriptions which have the biblionumber given on input arg. each element of this array is a hashref containing startdate, histstartdate,opacnote,missinglist,recievedlist,periodicity,status &#38; enddate</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetFullSubscriptionsFromBiblionumber"
>GetFullSubscriptionsFromBiblionumber</a></h2>

<pre>   $array_ref = GetFullSubscriptionsFromBiblionumber($biblionumber)
   this function reads the serial table.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="SearchSubscriptions"
>SearchSubscriptions</a></h2>

<pre>  @results = SearchSubscriptions($args);</pre>

<p>This function returns a list of hashrefs, one for each subscription that meets the conditions specified by the $args hashref.</p>

<p>The valid search fields are:</p>

<pre>  biblionumber
  title
  issn
  ean
  callnumber
  location
  publisher
  bookseller
  branch
  expiration_date
  closed</pre>

<p>The expiration_date search field is special; it specifies the maximum subscription expiration date.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSerials"
>GetSerials</a></h2>

<p>($totalissues,@serials) = GetSerials($subscriptionid); this function gets every serial not arrived for a given subscription as well as the number of issues registered in the database (all types) this number is used to see if a subscription can be deleted (=it must have only 1 issue)</p>

<p>FIXME: We should return \@serials.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSerials2"
>GetSerials2</a></h2>

<p>@serials = GetSerials2($subscriptionid,$statuses); this function returns every serial waited for a given subscription as well as the number of issues registered in the database (all types) this number is used to see if a subscription can be deleted (=it must have only 1 issue)</p>

<p>$statuses is an arrayref of statuses and is mandatory.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetLatestSerials"
>GetLatestSerials</a></h2>

<p>\@serials = GetLatestSerials($subscriptionid,$limit) get the $limit&#39;s latest serials arrived or missing for a given subscription return : a ref to an array which contains all of the latest serials stored into a hash.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetPreviousSerialid"
>GetPreviousSerialid</a></h2>

<p>$serialid = GetPreviousSerialid($subscriptionid, $nth) get the $nth&#39;s previous serial for the given subscriptionid return : the serialid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetNextSeq"
>GetNextSeq</a></h2>

<pre>    my (
        $nextseq,       $newlastvalue1, $newlastvalue2, $newlastvalue3,
        $newinnerloop1, $newinnerloop2, $newinnerloop3
    ) = GetNextSeq( $subscription, $pattern, $frequency, $planneddate );</pre>

<p>$subscription is a hashref containing all the attributes of the table &#39;subscription&#39;. $pattern is a hashref containing all the attributes of the table &#39;subscription_numberpatterns&#39;. $frequency is a hashref containing all the attributes of the table &#39;subscription_frequencies&#39; $planneddate is a date string in iso format. This function get the next issue for the subscription given on input arg</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSeq"
>GetSeq</a></h2>

<p>$calculated = GetSeq($subscription, $pattern) $subscription is a hashref containing all the attributes of the table &#39;subscription&#39; $pattern is a hashref containing all the attributes of the table &#39;subscription_numberpatterns&#39; this function transforms {X},{Y},{Z} to 150,0,0 for example. return: the sequence in string format</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetExpirationDate"
>GetExpirationDate</a></h2>

<p>$enddate = GetExpirationDate($subscriptionid, [$startdate])</p>

<p>this function return the next expiration date for a subscription given on input args.</p>

<p>return the enddate or undef</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CountSubscriptionFromBiblionumber"
>CountSubscriptionFromBiblionumber</a></h2>

<p>$subscriptionsnumber = CountSubscriptionFromBiblionumber($biblionumber) this returns a count of the subscriptions for a given biblionumber return : the number of subscriptions</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ModSubscriptionHistory"
>ModSubscriptionHistory</a></h2>

<p>ModSubscriptionHistory($subscriptionid,$histstartdate,$enddate,$recievedlist,$missinglist,$opacnote,$librariannote);</p>

<p>this function modifies the history of a subscription. Put your new values on input arg. returns the number of rows affected</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ModSerialStatus"
>ModSerialStatus</a></h2>

<pre>    ModSerialStatus($serialid, $serialseq, $planneddate, $publisheddate,
        $publisheddatetext, $status, $notes);</pre>

<p>This function modify the serial status. Serial status is a number.(eg 2 is &#34;arrived&#34;) Note : if we change from &#34;waited&#34; to something else,then we will have to create a new &#34;waited&#34; entry</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetNextExpected"
>GetNextExpected</a></h2>

<p>$nextexpected = GetNextExpected($subscriptionid)</p>

<p>Get the planneddate for the current expected issue of the subscription.</p>

<p>returns a hashref:</p>

<p>$nextexepected = { serialid =&#62; int planneddate =&#62; ISO date }</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ModNextExpected"
>ModNextExpected</a></h2>

<p>ModNextExpected($subscriptionid,$date)</p>

<p>Update the planneddate for the current expected issue of the subscription. This will modify all future prediction results.</p>

<p><code>$date</code> is an ISO date.</p>

<p>returns 0</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSubscriptionIrregularities"
>GetSubscriptionIrregularities</a></h2>

<dl>
<dt><a name="@irreg_=_&#38;GetSubscriptionIrregularities($subscriptionid);_get_the_list_of_irregularities_for_a_subscription"
>@irreg = &#38;GetSubscriptionIrregularities($subscriptionid); get the list of irregularities for a subscription</a></dt>
</dl>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ModSubscription"
>ModSubscription</a></h2>

<p>this function modifies a subscription. Put all new values on input args. returns the number of rows affected</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="NewSubscription"
>NewSubscription</a></h2>

<p>$subscriptionid = &#38;NewSubscription($auser,branchcode,$aqbooksellerid,$cost,$aqbudgetid,$biblionumber, $startdate,$periodicity,$numberlength,$weeklength,$monthlength, $lastvalue1,$innerloop1,$lastvalue2,$innerloop2,$lastvalue3,$innerloop3, $status, $notes, $letter, $firstacquidate, $irregularity, $numberpattern, $locale, $callnumber, $manualhistory, $internalnotes, $serialsadditems, $staffdisplaycount, $opacdisplaycount, $graceperiod, $location, $enddate, $skip_serialseq, $itemtype, $previousitemtype);</p>

<p>Create a new subscription with value given on input args.</p>

<p>return : the id of this new subscription</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetSubscriptionLength"
>GetSubscriptionLength</a></h2>

<p>my ($numberlength, $weeklength, $monthlength) = GetSubscriptionLength( $subtype, $sublength );</p>

<p>This function calculates the subscription length.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ReNewSubscription"
>ReNewSubscription</a></h2>

<p>ReNewSubscription($params);</p>

<p>$params is a hashref with the following keys: subscriptionid, user, startdate, numberlength, weeklength, monthlength, note, branchcode</p>

<p>this function renew a subscription with values given on input args.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="NewIssue"
>NewIssue</a></h2>

<p>NewIssue($serialseq,$subscriptionid,$biblionumber,$status, $planneddate, $publisheddate, $notes, $routingnotes)</p>

<p>Create a new issue stored on the database. Note : we have to update the recievedlist and missinglist on subscriptionhistory for this subscription. returns the serial id</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="HasSubscriptionStrictlyExpired"
>HasSubscriptionStrictlyExpired</a></h2>

<p>1 or 0 = HasSubscriptionStrictlyExpired($subscriptionid)</p>

<p>the subscription has stricly expired when today &#62; the end subscription date</p>

<p>return : 1 if true, 0 if false, -1 if the expiration date is not set.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="HasSubscriptionExpired"
>HasSubscriptionExpired</a></h2>

<p>$has_expired = HasSubscriptionExpired($subscriptionid)</p>

<p>the subscription has expired when the next issue to arrive is out of subscription limit.</p>

<p>return : 0 if the subscription has not expired 1 if the subscription has expired 2 if has subscription does not have a valid expiration date set</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DelSubscription"
>DelSubscription</a></h2>

<p>DelSubscription($subscriptionid) this function deletes subscription which has $subscriptionid as id.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DelIssue"
>DelIssue</a></h2>

<p>DelIssue($serialseq,$subscriptionid) this function deletes an issue which has $serialseq and $subscriptionid given on input arg.</p>

<p>returns the number of rows affected</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetLateOrMissingIssues"
>GetLateOrMissingIssues</a></h2>

<p>@issuelist = GetLateMissingIssues($supplierid,$serialid)</p>

<p>this function selects missing issues on database - where serial.status = MISSING* or serial.status = LATE or planneddate&#60;now</p>

<p>return : the issuelist as an array of hash refs. Each element of this array contains name,title,planneddate,serialseq,serial.subscriptionid from tables : subscription, serial &#38; biblio</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="updateClaim"
>updateClaim</a></h2>

<p>&#38;updateClaim($serialid)</p>

<p>this function updates the time when a claim is issued for late/missing items</p>

<p>called from claims.pl file</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="check_routing"
>check_routing</a></h2>

<p>$result = &#38;check_routing($subscriptionid)</p>

<p>this function checks to see if a serial has a routing list and returns the count of routingid used to show either an &#39;add&#39; or &#39;edit&#39; link</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="addroutingmember"
>addroutingmember</a></h2>

<p>addroutingmember($borrowernumber,$subscriptionid)</p>

<p>this function takes a borrowernumber and subscriptionid and adds the member to the routing list for that serial subscription and gives them a rank on the list of either 1 or highest current rank + 1</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="reorder_members"
>reorder_members</a></h2>

<p>reorder_members($subscriptionid,$routingid,$rank)</p>

<p>this function is used to reorder the routing list</p>

<p>it takes the routingid of the member one wants to re-rank and the rank it is to move to - it gets all members on list puts their routingid&#39;s into an array - removes the one in the array that is $routingid - then reinjects $routingid at point indicated by $rank - then update the database with the routingids in the new order</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="delroutingmember"
>delroutingmember</a></h2>

<p>delroutingmember($routingid,$subscriptionid)</p>

<p>this function either deletes one member from routing list if $routingid exists otherwise deletes all members from the routing list</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="getroutinglist"
>getroutinglist</a></h2>

<p>@routinglist = getroutinglist($subscriptionid)</p>

<p>this gets the info from the subscriptionroutinglist for $subscriptionid</p>

<p>return : the routinglist as an array. Each element of the array contains a hash_ref containing routingid - a unique id, borrowernumber, ranking, and biblionumber of subscription</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="countissuesfrom"
>countissuesfrom</a></h2>

<p>$result = countissuesfrom($subscriptionid,$startdate)</p>

<p>Returns a count of serial rows matching the given subsctiptionid with published date greater than startdate</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CountIssues"
>CountIssues</a></h2>

<p>$result = CountIssues($subscriptionid)</p>

<p>Returns a count of serial rows matching the given subsctiptionid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="HasItems"
>HasItems</a></h2>

<p>$result = HasItems($subscriptionid)</p>

<p>returns a count of items from serial matching the subscriptionid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="abouttoexpire"
>abouttoexpire</a></h2>

<p>$result = abouttoexpire($subscriptionid)</p>

<p>this function alerts you to the penultimate issue for a serial subscription</p>

<p>returns 1 - if this is the penultimate issue returns 0 - if not</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetFictiveIssueNumber"
>GetFictiveIssueNumber</a></h2>

<p>$issueno = GetFictiveIssueNumber($subscription, $publishedate, $frequency);</p>

<p>Get the position of the issue published at $publisheddate, considering the first issue (at firstacquidate) is at position 1, the next is at position 2, etc... This issuenumber doesn&#39;t take into account irregularities, so, for instance, if the 3rd issue is declared as &#39;irregular&#39; (will be skipped at receipt), the next issue number will be 4, not 3. It&#39;s why it is called &#39;fictive&#39;. It is NOT a serial seq, and is not depending on how many rows are in serial table. The issue number calculation is based on subscription frequency, first acquisition date, and $publisheddate.</p>

<p>Returns undef when called for irregular frequencies.</p>

<p>The routine is used to skip irregularities when calculating the next issue date (in GetNextDate) or the next issue number (in GetNextSeq).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetNextDate"
>GetNextDate</a></h2>

<p>$resultdate = GetNextDate($publisheddate,$subscription,$freqdata,$updatecount)</p>

<p>this function it takes the publisheddate and will return the next issue&#39;s date and will skip dates if there exists an irregularity. $publisheddate has to be an ISO date $subscription is a hashref containing at least &#39;firstacquidate&#39;, &#39;irregularity&#39;, and &#39;countissuesperunit&#39; $frequency is a hashref containing frequency informations $updatecount is a boolean value which, when set to true, update the &#39;countissuesperunit&#39; in database - eg if periodicity is monthly and $publisheddate is 2007-02-10 but if March and April is to be skipped then the returned date will be 2007-05-10</p>

<p>return : $resultdate - then next date in the sequence (ISO date)</p>

<p>Return undef if subscription is irregular</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_numeration"
>_numeration</a></h2>

<pre>  $string = &#38;_numeration($value,$num_type,$locale);</pre>

<p>_numeration returns the string corresponding to $value in the num_type num_type can take : -dayname -dayabrv -monthname -monthabrv -season -seasonabrv</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CloseSubscription"
>CloseSubscription</a></h2>

<p>Close a subscription given a subscriptionid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ReopenSubscription"
>ReopenSubscription</a></h2>

<p>Reopen a subscription given a subscriptionid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="subscriptionCurrentlyOnOrder"
>subscriptionCurrentlyOnOrder</a></h2>

<pre>    $bool = subscriptionCurrentlyOnOrder( $subscriptionid );</pre>

<p>Return 1 if subscription is currently on order else 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="can_claim_subscription"
>can_claim_subscription</a></h2>

<pre>    $can = can_claim_subscription( $subscriptionid[, $userid] );</pre>

<p>Return 1 if the subscription can be claimed by the current logged user (or a given $userid), else 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="can_edit_subscription"
>can_edit_subscription</a></h2>

<pre>    $can = can_edit_subscription( $subscriptionid[, $userid] );</pre>

<p>Return 1 if the subscription can be edited by the current logged user (or a given $userid), else 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="can_show_subscription"
>can_show_subscription</a></h2>

<pre>    $can = can_show_subscription( $subscriptionid[, $userid] );</pre>

<p>Return 1 if the subscription can be shown by the current logged user (or a given $userid), else 0.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="findSerialsByStatus"
>findSerialsByStatus</a></h2>

<pre>    @serials = findSerialsByStatus($status, $subscriptionid);

    Returns an array of serials matching a given status and subscription id.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Koha Development Team &#60;http://koha-community.org/&#62;</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
