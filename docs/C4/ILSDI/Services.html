<html><head><title>C4::ILS-DI::Services</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Mon Nov 11 12:08:29 2024 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#FUNCTIONS'>FUNCTIONS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#GetAvailability'>GetAvailability</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#id_(Required)'>id (Required)</a>
      <li class='indexItem indexItem3'><a href='#id_type_(Required)'>id_type (Required)</a>
      <li class='indexItem indexItem3'><a href='#return_type_(Optional)'>return_type (Optional)</a>
      <li class='indexItem indexItem3'><a href='#return_fmt_(Optional)'>return_fmt (Optional)</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#GetRecords'>GetRecords</a>
    <li class='indexItem indexItem2'><a href='#GetAuthorityRecords'>GetAuthorityRecords</a>
    <li class='indexItem indexItem2'><a href='#LookupPatron'>LookupPatron</a>
    <li class='indexItem indexItem2'><a href='#AuthenticatePatron'>AuthenticatePatron</a>
    <li class='indexItem indexItem2'><a href='#GetPatronInfo'>GetPatronInfo</a>
    <li class='indexItem indexItem2'><a href='#GetPatronStatus'>GetPatronStatus</a>
    <li class='indexItem indexItem2'><a href='#GetServices'>GetServices</a>
    <li class='indexItem indexItem2'><a href='#RenewLoan'>RenewLoan</a>
    <li class='indexItem indexItem2'><a href='#HoldTitle'>HoldTitle</a>
    <li class='indexItem indexItem2'><a href='#HoldItem'>HoldItem</a>
    <li class='indexItem indexItem2'><a href='#CancelHold'>CancelHold</a>
    <li class='indexItem indexItem2'><a href='#_availability'>_availability</a>
  </ul>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>C4::ILS-DI::Services - ILS-DI Services</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>Each function in this module represents an ILS-DI service.
They all takes a CGI instance as argument and most of them return a hashref that will be printed by XML::Simple in opac/ilsdi.pl</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use C4::ILSDI::Services;
    use XML::Simple;
    use CGI qw ( -utf8 );

    my $cgi = new CGI;

    $out = LookupPatron($cgi);

    print CGI::header(&#39;text/xml&#39;);
    print XMLout($out,
        noattr =&#62; 1,
        noescape =&#62; 1,
        nosort =&#62; 1,
                xmldecl =&#62; &#39;&#60;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&#62;&#39;,
        RootName =&#62; &#39;LookupPatron&#39;,
        SuppressEmpty =&#62; 1);</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="FUNCTIONS"
>FUNCTIONS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAvailability"
>GetAvailability</a></h2>

<p>Given a set of biblionumbers or itemnumbers, returns a list with availability of the items associated with the identifiers.</p>

<p>Parameters:</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="id_(Required)"
>id (Required)</a></h3>

<p>list of either biblionumbers or itemnumbers</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="id_type_(Required)"
>id_type (Required)</a></h3>

<p>defines the type of record identifier being used in the request, possible values:</p>

<pre>  - bib
  - item</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="return_type_(Optional)"
>return_type (Optional)</a></h3>

<p>requests a particular level of detail in reporting availability, possible values:</p>

<pre>  - bib
  - item</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="return_fmt_(Optional)"
>return_fmt (Optional)</a></h3>

<p>requests a particular format or set of formats in reporting availability</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetRecords"
>GetRecords</a></h2>

<p>Given a list of biblionumbers, returns a list of record objects that contain bibliographic information, as well as associated holdings and item information. The caller may request a specific metadata schema for the record objects to be returned.</p>

<p>This function behaves similarly to HarvestBibliographicRecords and HarvestExpandedRecords in Data Aggregation, but allows quick, real time lookup by bibliographic identifier.</p>

<p>You can use OAI-PMH ListRecords instead of this service.</p>

<p>Parameters:</p>

<pre>  - id (Required)
    list of system record identifiers
  - id_type (Optional)
    Defines the metadata schema in which the records are returned,
    possible values:
        - MARCXML</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAuthorityRecords"
>GetAuthorityRecords</a></h2>

<p>Given a list of authority record identifiers, returns a list of record objects that contain the authority records. The function user may request a specific metadata schema for the record objects.</p>

<p>Parameters:</p>

<pre>  - id (Required)
    list of authority record identifiers
  - schema (Optional)
    specifies the metadata schema of records to be returned, possible values:
      - MARCXML</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="LookupPatron"
>LookupPatron</a></h2>

<p>Looks up a patron in the ILS by an identifier, and returns the borrowernumber.</p>

<p>Parameters:</p>

<pre>  - id (Required)
    an identifier used to look up the patron in Koha
  - id_type (Optional)
    the type of the identifier, possible values:
    - cardnumber
    - userid
        - email
    - borrowernumber
    - firstname
        - surname</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AuthenticatePatron"
>AuthenticatePatron</a></h2>

<p>Authenticates a user&#39;s login credentials and returns the identifier for the patron.</p>

<p>Parameters:</p>

<pre>  - username (Required)
    user&#39;s login identifier (userid or cardnumber)
  - password (Required)
    user&#39;s password</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetPatronInfo"
>GetPatronInfo</a></h2>

<p>Returns specified information about the patron, based on options in the request. This function can optionally return patron&#39;s contact information, fine information, hold request information, and loan information.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    the borrowernumber
  - show_contact (Optional, default 1)
    whether or not to return patron&#39;s contact information in the response
  - show_fines (Optional, default 0)
    whether or not to return fine information in the response
  - show_holds (Optional, default 0)
    whether or not to return hold request information in the response
  - show_loans (Optional, default 0)
    whether or not to return loan information request information in the response
  - show_attributes (Optional, default 0)
    whether or not to return additional patron attributes, when enabled the attributes
    are limited to those marked as opac visible only.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetPatronStatus"
>GetPatronStatus</a></h2>

<p>Returns a patron&#39;s status information.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    the borrower ID</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetServices"
>GetServices</a></h2>

<p>Returns information about the services available on a particular item for a particular patron.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    a borrowernumber
  - item_id (Required)
    an itemnumber</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="RenewLoan"
>RenewLoan</a></h2>

<p>Extends the due date for a borrower&#39;s existing issue.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    a borrowernumber
  - item_id (Required)
    an itemnumber
  - desired_due_date (Required)
    the date the patron would like the item returned by</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="HoldTitle"
>HoldTitle</a></h2>

<p>Creates, for a borrower, a biblio-level hold reserve.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    a borrowernumber
  - bib_id (Required)
    a biblionumber
  - request_location (Required)
    IP address where the end user request is being placed
  - pickup_location (Optional)
    a branch code indicating the location to which to deliver the item for pickup
  - start_date (Optional)
    date after which hold request is no longer needed if the document has not been made available
  - expiry_date (Optional)
    date after which item returned to shelf if item is not picked up</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="HoldItem"
>HoldItem</a></h2>

<p>Creates, for a borrower, an item-level hold request on a specific item of a bibliographic record in Koha.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
    a borrowernumber
  - bib_id (Required)
    a biblionumber
  - item_id (Required)
    an itemnumber
  - pickup_location (Optional)
    a branch code indicating the location to which to deliver the item for pickup
  - start_date (Optional)
    date after which hold request is no longer needed if the item has not been made available
  - expiry_date (Optional)
    date after which item returned to shelf if item is not picked up</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CancelHold"
>CancelHold</a></h2>

<p>Cancels an active reserve request for the borrower.</p>

<p>Parameters:</p>

<pre>  - patron_id (Required)
        a borrowernumber
  - item_id (Required)
        a reserve_id</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_availability"
>_availability</a></h2>

<p>Returns, for an itemnumber, an array containing availability information.</p>

<pre> my ($biblionumber, $status, $msg, $location) = _availability($id);</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
