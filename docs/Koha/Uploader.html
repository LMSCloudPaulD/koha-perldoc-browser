<html><head><title>Koha::Uploader</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.43,
  using Pod::Simple::PullParser v3.43,
  under Perl v5.038002 at Sat Jan 18 18:05:39 2025 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#INSTANCE_METHODS'>INSTANCE METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#cgi'>cgi</a>
    <li class='indexItem indexItem2'><a href='#count'>count</a>
    <li class='indexItem indexItem2'><a href='#result'>result</a>
    <li class='indexItem indexItem2'><a href='#err'>err</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#CLASS_METHODS'>CLASS METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#allows_add_by'>allows_add_by</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_ROUTINES'>INTERNAL ROUTINES</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Uploader - Facilitate file uploads (temporary and permanent)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Koha::Uploader;
    use Koha::UploadedFile;
    use Koha::UploadedFiles;

    # add an upload (see tools/upload-file.pl)
    # the public flag allows retrieval via OPAC
    my $upload = Koha::Uploader-&#62;new( public =&#62; 1, category =&#62; &#39;A&#39; );
    my $cgi = $upload-&#62;cgi;
    # Do something with $upload-&#62;count, $upload-&#62;result or $upload-&#62;err

    # get some upload records (in staff) via Koha::UploadedFiles
    my $uploads1 = Koha::UploadedFiles-&#62;search({ filename =&#62; $name });
    my $uploads2 = Koha::UploadedFiles-&#62;search_term({ term =&#62; $term });

    # staff download (via Koha::UploadedFile[s])
    my $rec = Koha::UploadedFiles-&#62;find( $id );
    my $fh = $rec-&#62;file_handle;
    print Encode::encode_utf8( $input-&#62;header( $rec-&#62;httpheaders ) );
    while( &#60;$fh&#62; ) { print $_; }
    $fh-&#62;close;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<pre>    This module is a refactored version of C4::UploadedFile but adds on top
    of that the new functions from report 6874 (Upload plugin in editor).
    That report added module UploadedFiles.pm. This module contains the
    functionality of both.

    The module has been revised to use Koha::Object[s]; the delete method
    has been moved to Koha::UploadedFile[s], as well as the get method.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INSTANCE_METHODS"
>INSTANCE METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    Returns new object based on Class::Accessor.
    Use tmp or temp flag for temporary storage.
    Use public flag to mark uploads as available in OPAC.
    The category parameter is only useful for permanent storage.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="cgi"
>cgi</a></h2>

<pre>    Returns CGI object. The CGI hook is used to store the uploaded files.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="count"
>count</a></h2>

<pre>    Returns number of uploaded files without errors</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="result"
>result</a></h2>

<pre>    Returns a string of id&#39;s for each successful upload separated by commas.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="err"
>err</a></h2>

<pre>    Returns hashref with errors in format { file =&#62; { code =&#62; err }, ... }
    Undefined if there are no errors.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CLASS_METHODS"
>CLASS METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="allows_add_by"
>allows_add_by</a></h2>

<pre>    allows_add_by checks if $userid has permission to add uploaded files</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_ROUTINES"
>INTERNAL ROUTINES</a></h1>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<pre>    Koha Development Team
    Larger parts from Galen Charlton, Julian Maurice and Marcel de Rooy</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
