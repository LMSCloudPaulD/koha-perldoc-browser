<html><head><title>C4::AuthoritiesMarc</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Mon Oct 23 12:17:30 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#GetAuthMARCFromKohaField'>GetAuthMARCFromKohaField</a>
    <li class='indexItem indexItem2'><a href='#SearchAuthorities'>SearchAuthorities</a>
    <li class='indexItem indexItem2'><a href='#GuessAuthTypeCode'>GuessAuthTypeCode</a>
    <li class='indexItem indexItem2'><a href='#GuessAuthId'>GuessAuthId</a>
    <li class='indexItem indexItem2'><a href='#GetTagsLabels'>GetTagsLabels</a>
    <li class='indexItem indexItem2'><a href='#AddAuthority'>AddAuthority</a>
    <li class='indexItem indexItem2'><a href='#DelAuthority'>DelAuthority</a>
    <li class='indexItem indexItem2'><a href='#ModAuthority'>ModAuthority</a>
    <li class='indexItem indexItem2'><a href='#GetAuthorityXML'>GetAuthorityXML</a>
    <li class='indexItem indexItem2'><a href='#GetAuthority'>GetAuthority</a>
    <li class='indexItem indexItem2'><a href='#FindDuplicateAuthority'>FindDuplicateAuthority</a>
    <li class='indexItem indexItem2'><a href='#BuildSummary'>BuildSummary</a>
    <li class='indexItem indexItem2'><a href='#GetAuthorizedHeading'>GetAuthorizedHeading</a>
    <li class='indexItem indexItem2'><a href='#CompareFieldWithAuthority'>CompareFieldWithAuthority</a>
    <li class='indexItem indexItem2'><a href='#BuildAuthHierarchies'>BuildAuthHierarchies</a>
    <li class='indexItem indexItem2'><a href='#BuildAuthHierarchy'>BuildAuthHierarchy</a>
    <li class='indexItem indexItem2'><a href='#BuildAuthHierarchyBranch'>BuildAuthHierarchyBranch</a>
    <li class='indexItem indexItem2'><a href='#GenerateHierarchy'>GenerateHierarchy</a>
    <li class='indexItem indexItem2'><a href='#GetHeaderAuthority'>GetHeaderAuthority</a>
    <li class='indexItem indexItem2'><a href='#AddAuthorityTrees'>AddAuthorityTrees</a>
    <li class='indexItem indexItem2'><a href='#merge'>merge</a>
    <li class='indexItem indexItem2'><a href='#get_auth_type_location'>get_auth_type_location</a>
    <li class='indexItem indexItem2'><a href='#compare_fields'>compare_fields</a>
    <li class='indexItem indexItem2'><a href='#_after_authority_action_hooks'>_after_authority_action_hooks</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>C4::AuthoritiesMarc</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAuthMARCFromKohaField"
>GetAuthMARCFromKohaField</a></h2>

<pre>  ( $tag, $subfield ) = &#38;GetAuthMARCFromKohaField ($kohafield,$authtypecode);</pre>

<p>returns tag and subfield linked to kohafield</p>

<p>Comment : Suppose Kohafield is only linked to ONE subfield</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="SearchAuthorities"
>SearchAuthorities</a></h2>

<pre>  (\@finalresult, $nbresults)= &#38;SearchAuthorities($tags, $and_or, 
     $excluding, $operator, $value, $offset,$length,$authtypecode,
     $sortby[, $skipmetadata])</pre>

<p>returns ref to array result and count of results returned</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GuessAuthTypeCode"
>GuessAuthTypeCode</a></h2>

<pre>  my $authtypecode = GuessAuthTypeCode($record);</pre>

<p>Get the record and tries to guess the adequate authtypecode from its content.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GuessAuthId"
>GuessAuthId</a></h2>

<pre>  my $authtid = GuessAuthId($record);</pre>

<p>Get the record and tries to guess the adequate authtypecode from its content.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetTagsLabels"
>GetTagsLabels</a></h2>

<pre>  $tagslabel= &#38;GetTagsLabels($forlibrarian,$authtypecode)</pre>

<p>returns a ref to hashref of authorities tag and subfield structure.</p>

<p>tagslabel usage :</p>

<pre>  $tagslabel-&#62;{$tag}-&#62;{$subfield}-&#62;{&#39;attribute&#39;}</pre>

<p>where attribute takes values in :</p>

<pre>  lib
  tab
  mandatory
  repeatable
  authorised_value
  authtypecode
  value_builder
  kohafield
  seealso
  hidden
  isurl
  link</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AddAuthority"
>AddAuthority</a></h2>

<pre>  $authid= &#38;AddAuthority($record, $authid,$authtypecode)</pre>

<p>Either Create Or Modify existing authority. returns authid of the newly created authority</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="DelAuthority"
>DelAuthority</a></h2>

<pre>    DelAuthority({ authid =&#62; $authid, [ skip_merge =&#62; 1 ] });</pre>

<p>Deletes $authid and calls merge to cleanup linked biblio records. Parameter skip_merge is used in authorities/merge.pl. You should normally not use it.</p>

<p>skip_record_index will skip the indexation step.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ModAuthority"
>ModAuthority</a></h2>

<pre>  $authid= &#38;ModAuthority($authid,$record,$authtypecode, [ { skip_merge =&#62; 1 ] )</pre>

<p>Modifies authority record, optionally updates attached biblios. The parameter skip_merge is optional and should be used with care.</p>

<p>skip_record_index will skip the indexation step.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAuthorityXML"
>GetAuthorityXML</a></h2>

<pre>  $marcxml= &#38;GetAuthorityXML( $authid)</pre>

<p>returns xml form of record $authid</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAuthority"
>GetAuthority</a></h2>

<pre>  $record= &#38;GetAuthority( $authid)</pre>

<p>Returns MARC::Record of the authority passed in parameter.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="FindDuplicateAuthority"
>FindDuplicateAuthority</a></h2>

<pre>  $record= &#38;FindDuplicateAuthority( $record, $authtypecode)</pre>

<p>return $authid,Summary if duplicate is found.</p>

<p>Comments : an improvement would be to return All the records that match.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="BuildSummary"
>BuildSummary</a></h2>

<pre>  $summary= &#38;BuildSummary( $record, $authid, $authtypecode)</pre>

<p>Returns a hashref with a summary of the specified record.</p>

<p>Comment : authtypecode can be inferred from both record and authid. Moreover, authid can also be inferred from $record. Would it be interesting to delete those things.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetAuthorizedHeading"
>GetAuthorizedHeading</a></h2>

<pre>  $heading = &#38;GetAuthorizedHeading({ record =&#62; $record, authid =&#62; $authid })</pre>

<p>Takes a MARC::Record object describing an authority record or an authid, and returns a string representation of the first authorized heading. This routine should be considered a temporary shim to ease the future migration of authority data from C4::AuthoritiesMarc to the object-oriented Koha::*::Authority.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="CompareFieldWithAuthority"
>CompareFieldWithAuthority</a></h2>

<pre>  $match = &#38;CompareFieldWithAuthority({ field =&#62; $field, authid =&#62; $authid })</pre>

<p>Takes a MARC::Field from a bibliographic record and an authid, and returns true if they match.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="BuildAuthHierarchies"
>BuildAuthHierarchies</a></h2>

<pre>  $text= &#38;BuildAuthHierarchies( $authid, $force)</pre>

<p>return text containing trees for hierarchies for them to be stored in auth_header</p>

<p>Example of text: 122,1314,2452;1324,2342,3,2452</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="BuildAuthHierarchy"
>BuildAuthHierarchy</a></h2>

<pre>  $ref= &#38;BuildAuthHierarchy( $record, $class,$authid)</pre>

<p>return a hashref in order to display hierarchy for record and final Authid $authid</p>

<p>&#34;loopparents&#34; &#34;loopchildren&#34; &#34;class&#34; &#34;loopauthid&#34; &#34;current_value&#34; &#34;value&#34;</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="BuildAuthHierarchyBranch"
>BuildAuthHierarchyBranch</a></h2>

<pre>  $branch = &#38;BuildAuthHierarchyBranch( $tree, $authid[, $cnt])</pre>

<p>Return a data structure representing an authority hierarchy given a list of authorities representing a single branch in an authority hierarchy tree. $authid is the current node in the tree (which may or may not be somewhere in the middle). $cnt represents the level of the upper-most item, and is only used when BuildAuthHierarchyBranch is called recursively (i.e., don&#39;t ever pass in anything but zero to it).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GenerateHierarchy"
>GenerateHierarchy</a></h2>

<pre>  $hierarchy = &#38;GenerateHierarchy($authid);</pre>

<p>Return an arrayref holding one or more &#34;trees&#34; representing authority hierarchies.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetHeaderAuthority"
>GetHeaderAuthority</a></h2>

<pre>  $ref= &#38;GetHeaderAuthority( $authid)</pre>

<p>return a hashref in order auth_header table data</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="AddAuthorityTrees"
>AddAuthorityTrees</a></h2>

<pre>  $ref= &#38;AddAuthorityTrees( $authid, $trees)</pre>

<p>return success or failure</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="merge"
>merge</a></h2>

<pre>    $count = merge({
        mergefrom =&#62; $mergefrom,
        [ MARCfrom =&#62; $MARCfrom, ]
        [ mergeto =&#62; $mergeto, ]
        [ MARCto =&#62; $MARCto, ]
        [ biblionumbers =&#62; [ $a, $b, $c ], ]
        [ override_limit =&#62; 1, ]
    });</pre>

<p>Merge biblios linked to authority $mergefrom (mandatory parameter). If $mergeto equals mergefrom, the linked biblio field is updated. If $mergeto is different, the biblio field will be linked to $mergeto. If $mergeto is missing, the biblio field is deleted.</p>

<p>MARCfrom is used to determine if a cleared subfield in the authority record should be removed from a biblio. MARCto is used to populate the biblio record with the updated values; if you do not pass it, the biblio field will be deleted (same as missing mergeto).</p>

<p>Normally all biblio records linked to $mergefrom, will be considered. But you can pass specific numbers via the biblionumbers parameter.</p>

<p>The parameter override_limit is used by the cron job to force larger postponed merges.</p>

<p>Note: Although $mergefrom and $mergeto will normally be of the same authority type, merge also supports moving to another authority type.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="get_auth_type_location"
>get_auth_type_location</a></h2>

<pre>  my ($tag, $subfield) = get_auth_type_location($auth_type_code);</pre>

<p>Get the tag and subfield used to store the heading type for indexing purposes. The <code>$auth_type</code> parameter is optional; if it is not supplied, assume &#39;&#39;.</p>

<p>This routine searches the MARC authority framework for the tag and subfield whose kohafield is <code>auth_header.authtypecode</code>; if no such field is defined in the framework, default to the hardcoded value specific to the MARC format.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="compare_fields"
>compare_fields</a></h2>

<pre>  my match = compare_fields($field1, $field2, &#39;abcde&#39;);</pre>

<p>Compares the listed subfields of both fields and return true if they all match</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_after_authority_action_hooks"
>_after_authority_action_hooks</a></h2>

<p>Helper method that takes care of calling all plugin hooks</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Koha Development Team &#60;http://koha-community.org/&#62;</p>

<p>Paul POULAIN paul.poulain@free.fr Ere Maijala ere.maijala@helsinki.fi</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
