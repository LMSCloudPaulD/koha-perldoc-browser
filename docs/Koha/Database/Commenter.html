<html><head><title>Koha::Database::Commenter</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Fri Dec  6 18:06:40 2024 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new'>new</a>
    <li class='indexItem indexItem2'><a href='#clear'>clear</a>
    <li class='indexItem indexItem2'><a href='#reset_to_schema'>reset_to_schema</a>
    <li class='indexItem indexItem2'><a href='#renumber'>renumber</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_ROUTINES'>INTERNAL ROUTINES</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_find_schema'>_find_schema</a>
    <li class='indexItem indexItem2'><a href='#_fetch_schema_comments'>_fetch_schema_comments</a>
    <li class='indexItem indexItem2'><a href='#_fetch_stored_comments'>_fetch_stored_comments</a>
    <li class='indexItem indexItem2'><a href='#_change_column'>_change_column</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#ADDITIONAL_COMMENTS'>ADDITIONAL COMMENTS</a>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Database::Commenter - Manage column comments in database</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<pre>    use Koha::Database::Commenter;
    $mgr = Koha::Database::Commenter-&#62;new({ dbh =&#62; $dbh });

    $mgr-&#62;reset_to_schema;
    # OR:
    $mgr-&#62;clear;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<pre>    This object helps you to keep column comments in your database in sync
    with the Koha schema. It also allows you to clear all comments.

    The advantage of keeping in sync is that you can easily track differences
    between schema and database with the maintenance script
    update_dbix_class_files.pl.

    Tip: make a backup of your database before running this script.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new"
>new</a></h2>

<pre>    $mgr = Koha::Database::Commenter-&#62;new({
        dbh =&#62; $dbh, database =&#62; $d, schema_file =&#62; $s
    });

    Object constructor.
    Param dbh is mandatory. Params database and schema_file are
    optional.
    Param database can be used to move away from current database of
    db handle.
    Param schema_file is needed for resetting to schema. Falls back to
    the constant for Koha structure file.</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="clear"
>clear</a></h2>

<pre>    $object-&#62;clear({ dry_run =&#62; 0, table =&#62; $table }, $messages );

    Clears all current column comments in storage.
    If table is passed, only that table is changed.
    Dry run only returns sql statements in $messages (arrayref).</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="reset_to_schema"
>reset_to_schema</a></h2>

<pre>    $object-&#62;reset_to_schema({ dry_run =&#62; 0, table =&#62; $table }, $messages );

    Resets column comments in storage to schema definition.
    Other column comments are cleared.
    When you pass table, only that table is changed.
    Dry run only returns sql statements in $messages (arrayref).</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="renumber"
>renumber</a></h2>

<pre>    $object-&#62;renumber({ dry_run =&#62; 0, table =&#62; $table }, $messages );

    This is primarily meant for testing purposes (verifying results across
    whole database).
    It adds comments like Comment_1, Comment_2 etc.
    When you pass table, only that table is changed. Otherwise all tables
    are affected; note that the column counter does not reset by table.
    Dry run only returns sql statements in $messages (arrayref).</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_ROUTINES"
>INTERNAL ROUTINES</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_find_schema"
>_find_schema</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_fetch_schema_comments"
>_fetch_schema_comments</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_fetch_stored_comments"
>_fetch_stored_comments</a></h2>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_change_column"
>_change_column</a></h2>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ADDITIONAL_COMMENTS"
>ADDITIONAL COMMENTS</a></h1>

<pre>    The module contains the core code for the options of the maintenance
    script sync_db_comments.pl.

    It can be tested additionally with Commenter.t, but note that since
    SQL DDL statements - as generated by this module - implicitly commit,
    we are not modifying actual Koha tables in that test.</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<pre>    Marcel de Rooy, Rijksmuseum Amsterdam, The Netherlands</pre>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
