<html><head><title>Koha::Illrequest</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçÉ</text></svg>" />

<link rel="stylesheet" href="../sub.css">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../_whtpurk.css" media="all" >

<script type="text/javascript" src="../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.42,
  using Pod::Simple::PullParser v3.42,
  under Perl v5.034000 at Thu May 11 12:26:51 2023 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#(Re)Design'>(Re)Design</a>
  <li class='indexItem indexItem1'><a href='#API'>API</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Backend_API_Response_Principles'>Backend API Response Principles</a>
    <li class='indexItem indexItem2'><a href='#Interface_Status_Messages'>Interface Status Messages</a>
    <li class='indexItem indexItem2'><a href='#Class_methods'>Class methods</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#init_processors'>init_processors</a>
      <li class='indexItem indexItem3'><a href='#push_processor'>push_processor</a>
      <li class='indexItem indexItem3'><a href='#statusalias'>statusalias</a>
      <li class='indexItem indexItem3'><a href='#illrequestattributes'>illrequestattributes</a>
      <li class='indexItem indexItem3'><a href='#illcomments'>illcomments</a>
      <li class='indexItem indexItem3'><a href='#comments'>comments</a>
      <li class='indexItem indexItem3'><a href='#logs'>logs</a>
      <li class='indexItem indexItem3'><a href='#patron'>patron</a>
      <li class='indexItem indexItem3'><a href='#library'>library</a>
      <li class='indexItem indexItem3'><a href='#extended_attributes'>extended_attributes</a>
      <li class='indexItem indexItem3'><a href='#status_alias'>status_alias</a>
      <li class='indexItem indexItem3'><a href='#status'>status</a>
      <li class='indexItem indexItem3'><a href='#load_backend'>load_backend</a>
      <li class='indexItem indexItem3'><a href='#_backend'>_backend</a>
      <li class='indexItem indexItem3'><a href='#_backend_capability'>_backend_capability</a>
      <li class='indexItem indexItem3'><a href='#_config'>_config</a>
      <li class='indexItem indexItem3'><a href='#metadata'>metadata</a>
      <li class='indexItem indexItem3'><a href='#_core_status_graph'>_core_status_graph</a>
      <li class='indexItem indexItem3'><a href='#_status_graph_union'>_status_graph_union</a>
      <li class='indexItem indexItem3'><a href='#capabilities'>capabilities</a>
      <li class='indexItem indexItem3'><a href='#custom_capability'>custom_capability</a>
      <li class='indexItem indexItem3'><a href='#available_backends'>available_backends</a>
      <li class='indexItem indexItem3'><a href='#available_actions'>available_actions</a>
      <li class='indexItem indexItem3'><a href='#mark_completed'>mark_completed</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#backend_illview'>backend_illview</a>
    <li class='indexItem indexItem2'><a href='#backend_migrate'>backend_migrate</a>
    <li class='indexItem indexItem2'><a href='#backend_confirm'>backend_confirm</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#backend_update_status'>backend_update_status</a>
      <li class='indexItem indexItem3'><a href='#backend_cancel'>backend_cancel</a>
      <li class='indexItem indexItem3'><a href='#backend_renew'>backend_renew</a>
      <li class='indexItem indexItem3'><a href='#backend_create'>backend_create</a>
      <li class='indexItem indexItem3'><a href='#backend_get_update'>backend_get_update</a>
      <li class='indexItem indexItem3'><a href='#expandTemplate'>expandTemplate</a>
      <li class='indexItem indexItem3'><a href='#getLimits'>getLimits</a>
      <li class='indexItem indexItem3'><a href='#getPrefix'>getPrefix</a>
      <li class='indexItem indexItem3'><a href='#get_type'>get_type</a>
      <li class='indexItem indexItem3'><a href='#check_limits'>check_limits</a>
      <li class='indexItem indexItem3'><a href='#requires_moderation'>requires_moderation</a>
      <li class='indexItem indexItem3'><a href='#biblio'>biblio</a>
      <li class='indexItem indexItem3'><a href='#check_out'>check_out</a>
      <li class='indexItem indexItem3'><a href='#generic_confirm'>generic_confirm</a>
      <li class='indexItem indexItem3'><a href='#send_patron_notice'>send_patron_notice</a>
      <li class='indexItem indexItem3'><a href='#send_staff_notice'>send_staff_notice</a>
      <li class='indexItem indexItem3'><a href='#get_notice'>get_notice</a>
      <li class='indexItem indexItem3'><a href='#attach_processors'>attach_processors</a>
      <li class='indexItem indexItem3'><a href='#append_to_note'>append_to_note</a>
      <li class='indexItem indexItem3'><a href='#id_prefix'>id_prefix</a>
      <li class='indexItem indexItem3'><a href='#_censor'>_censor</a>
      <li class='indexItem indexItem3'><a href='#store'>store</a>
      <li class='indexItem indexItem3'><a href='#requested_partners'>requested_partners</a>
      <li class='indexItem indexItem3'><a href='#TO_JSON'>TO_JSON</a>
    </ul>
    <li class='indexItem indexItem2'><a href='#Internal_methods'>Internal methods</a>
    <ul   class='indexList indexList3'>
      <li class='indexItem indexItem3'><a href='#to_api_mapping'>to_api_mapping</a>
      <li class='indexItem indexItem3'><a href='#strings_map'>strings_map</a>
      <li class='indexItem indexItem3'><a href='#_type'>_type</a>
    </ul>
  </ul>
  <li class='indexItem indexItem1'><a href='#AUTHOR'>AUTHOR</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Koha::Illrequest - Koha Illrequest Object class</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="(Re)Design"
>(Re)Design</a></h1>

<p>An ILLRequest consists of two parts; the Illrequest Koha::Object,
and a series of related Illrequestattributes.</p>

<p>The former encapsulates the basic necessary information that any ILL requires to be usable in Koha.
The latter is a set of additional properties used by one of the backends.</p>

<p>The former subsumes the legacy &#34;Status&#34; object.
The latter remains encapsulated in the &#34;Record&#34; object.</p>

<p>TODO:</p>

<p>- Anything invoking the -&#62;status method; annotated with: + # Old use of -&#62;status !</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="API"
>API</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Backend_API_Response_Principles"
>Backend API Response Principles</a></h2>

<p>All methods should return a hashref in the following format:</p>

<ul>
<li>error
<p>This should be set to 1 if an error was encountered.</p>
</li>

<li>status
<p>The status should be a string from the list of statuses detailed below.</p>
</li>

<li>message
<p>The message is a free text field that can be passed on to the end user.</p>
</li>

<li>value
<p>The value returned by the method.</p>
</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Interface_Status_Messages"
>Interface Status Messages</a></h2>

<ul>
<li>branch_address_incomplete
<p>An interface request has determined branch address details are incomplete.</p>
</li>

<li>cancel_success
<p>The interface&#39;s cancel_request method was successful in cancelling the Illrequest using the API.</p>
</li>

<li>cancel_fail
<p>The interface&#39;s cancel_request method failed to cancel the Illrequest using the API.</p>
</li>

<li>unavailable
<p>The interface&#39;s request method returned saying that the desired item is not available for request.</p>
</li>
</ul>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Class_methods"
>Class methods</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="init_processors"
>init_processors</a></h3>

<pre>    $request-&#62;init_processors()</pre>

<p>Initialises an empty processors arrayref</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="push_processor"
>push_processor</a></h3>

<pre>    $request-&#62;push_processors(sub { ...something... });</pre>

<p>Pushes a passed processor function into our processors arrayref</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="statusalias"
>statusalias</a></h3>

<pre>    my $statusalias = $request-&#62;statusalias;</pre>

<p>Returns a request&#39;s status alias, as a Koha::AuthorisedValue instance or implicit undef. This is distinct from status_alias, which only returns the value in the status_alias column, this method returns the entire AuthorisedValue object</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="illrequestattributes"
>illrequestattributes</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="illcomments"
>illcomments</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="comments"
>comments</a></h3>

<pre>    my $ill_comments = $req-&#62;comments;</pre>

<p>Returns a <i>Koha::Illcomments</i> resultset for the linked comments.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="logs"
>logs</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="patron"
>patron</a></h3>

<pre>    my $patron = $request-&#62;patron;</pre>

<p>Returns the linked <i>Koha::Patron</i> object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="library"
>library</a></h3>

<pre>    my $library = $request-&#62;library;</pre>

<p>Returns the linked <i>Koha::Library</i> object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="extended_attributes"
>extended_attributes</a></h3>

<pre>    my $extended_attributes = $request-&#62;extended_attributes;</pre>

<p>Returns the linked <i>Koha::Illrequestattributes</i> resultset object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="status_alias"
>status_alias</a></h3>

<pre>    $Illrequest-&#62;status_alias(143);</pre>

<p>Overloaded getter/setter for status_alias, that only returns authorised values from the correct category and records the fact that the status has changed</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="status"
>status</a></h3>

<pre>    $Illrequest-&#62;status(&#39;CANREQ&#39;);</pre>

<p>Overloaded getter/setter for request status, also nullifies status_alias and records the fact that the status has changed and sends a notice if appropriate</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="load_backend"
>load_backend</a></h3>

<p>Require &#34;Base.pm&#34; from the relevant ILL backend.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_backend"
>_backend</a></h3>

<pre>    my $backend = $abstract-&#62;_backend($new_backend);
    my $backend = $abstract-&#62;_backend;</pre>

<p>Getter/Setter for our API object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_backend_capability"
>_backend_capability</a></h3>

<pre>    my $backend_capability_result = $self-&#62;_backend_capability($name, $args);</pre>

<p>This is a helper method to invoke optional capabilities in the backend. If the capability named by $name is not supported, return 0, else invoke it, passing $args along with the invocation, and return its return value.</p>

<p>NOTE: this module suffers from a confusion in termninology:</p>

<p>in _backend_capability, the notion of capability refers to an optional feature that is implemented in core, but might not be supported by a given backend.</p>

<p>in capabilities &#38; custom_capability, capability refers to entries in the status_graph (after union between backend and core).</p>

<p>The easiest way to fix this would be to fix the terminology in capabilities &#38; custom_capability and their callers.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_config"
>_config</a></h3>

<pre>    my $config = $abstract-&#62;_config($config);
    my $config = $abstract-&#62;_config;</pre>

<p>Getter/Setter for our config object.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="metadata"
>metadata</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_core_status_graph"
>_core_status_graph</a></h3>

<pre>    my $core_status_graph = $illrequest-&#62;_core_status_graph;</pre>

<p>Returns ILL module&#39;s default status graph. A status graph defines the list of available actions at any stage in the ILL workflow. This is for instance used by the perl script &#38; template to generate the correct buttons to display to the end user at any given point.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_status_graph_union"
>_status_graph_union</a></h3>

<pre>    my $status_graph = $illrequest-&#62;_status_graph_union($origin, $new_graph);</pre>

<p>Return a new status_graph, the result of merging $origin &#38; new_graph. This is operation is a union over the sets defied by the two graphs.</p>

<p>Each entry in $new_graph is added to $origin. We do not provide a syntax for &#39;subtraction&#39; of entries from $origin.</p>

<p>Whilst it is not intended that this works, you can override entries in $origin with entries with the same key in $new_graph. This can lead to problematic behaviour when $new_graph adds an entry, which modifies a dependent entry in $origin, only for the entry in $origin to be replaced later with a new entry from $new_graph.</p>

<p>NOTE: this procedure does not &#34;re-link&#34; entries in $origin or $new_graph, i.e. each of the graphs need to be correct at the outset of the operation.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="capabilities"
>capabilities</a></h3>

<pre>    my $capabilities = $illrequest-&#62;capabilities;</pre>

<p>Return a hashref mapping methods to operation names supported by the queried backend.</p>

<p>Example return value:</p>

<pre>    { create =&#62; &#34;Create Request&#34;, confirm =&#62; &#34;Progress Request&#34; }</pre>

<p>NOTE: this module suffers from a confusion in termninology:</p>

<p>in _backend_capability, the notion of capability refers to an optional feature that is implemented in core, but might not be supported by a given backend.</p>

<p>in capabilities &#38; custom_capability, capability refers to entries in the status_graph (after union between backend and core).</p>

<p>The easiest way to fix this would be to fix the terminology in capabilities &#38; custom_capability and their callers.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="custom_capability"
>custom_capability</a></h3>

<p>Return the result of invoking $CANDIDATE on this request&#39;s backend with $PARAMS, or 0 if $CANDIDATE is an unknown method on backend.</p>

<p>NOTE: this module suffers from a confusion in termninology:</p>

<p>in _backend_capability, the notion of capability refers to an optional feature that is implemented in core, but might not be supported by a given backend.</p>

<p>in capabilities &#38; custom_capability, capability refers to entries in the status_graph (after union between backend and core).</p>

<p>The easiest way to fix this would be to fix the terminology in capabilities &#38; custom_capability and their callers.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="available_backends"
>available_backends</a></h3>

<p>Return a list of available backends.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="available_actions"
>available_actions</a></h3>

<p>Return a list of available actions.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="mark_completed"
>mark_completed</a></h3>

<p>Mark a request as completed (status = COMP).</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="backend_illview"
>backend_illview</a></h2>

<p>View and manage an ILL request</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="backend_migrate"
>backend_migrate</a></h2>

<p>Migrate a request from one backend to another.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="backend_confirm"
>backend_confirm</a></h2>

<p>Confirm a request. The backend handles setting of mandatory fields in the commit stage:</p>

<ul>
<li>orderid</li>

<li>accessurl, cost (if available).</li>
</ul>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="backend_update_status"
>backend_update_status</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="backend_cancel"
>backend_cancel</a></h3>

<pre>    my $ILLResponse = $illRequest-&#62;backend_cancel;</pre>

<p>The standard interface method allowing for request cancellation.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="backend_renew"
>backend_renew</a></h3>

<pre>    my $renew_response = $illRequest-&#62;backend_renew;</pre>

<p>The standard interface method allowing for request renewal queries.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="backend_create"
>backend_create</a></h3>

<pre>    my $create_response = $abstractILL-&#62;backend_create($params);</pre>

<p>Return an array of Record objects created by querying our backend with a Search query.</p>

<p>In the context of the other ILL methods, this is a special method: we only pass it $params, as it does not yet have any other data associated with it.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="backend_get_update"
>backend_get_update</a></h3>

<pre>    my $update = backend_get_update($request);

    Given a request, returns an update in a prescribed
    format that can then be passed to update parsers</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="expandTemplate"
>expandTemplate</a></h3>

<pre>    my $params = $abstract-&#62;expandTemplate($params);</pre>

<p>Return a version of $PARAMS augmented with our required template path.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="getLimits"
>getLimits</a></h3>

<pre>    my $limit_rules = $abstract-&#62;getLimits( {
        type  =&#62; &#39;brw_cat&#39; | &#39;branch&#39;,
        value =&#62; $value
    } );</pre>

<p>Return the ILL limit rules for the supplied combination of type / value.</p>

<p>As the config may have no rules for this particular type / value combination, or for the default, we must define fall-back values here.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="getPrefix"
>getPrefix</a></h3>

<pre>    my $prefix = $abstract-&#62;getPrefix( {
        branch  =&#62; $branch_code
    } );</pre>

<p>Return the ILL prefix as defined by our $params: either per borrower category, per branch or the default.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_type"
>get_type</a></h3>

<pre>    my $type = $abstract-&#62;get_type();</pre>

<p>Return a string representing the material type of this request or undef</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="check_limits"
>check_limits</a></h3>

<pre>    my $ok = $illRequests-&#62;check_limits( {
        borrower   =&#62; $borrower,
        branchcode =&#62; &#39;branchcode&#39; | undef,
    } );</pre>

<p>Given $PARAMS, a hashref containing a $borrower object and a $branchcode, see whether we are still able to place ILLs.</p>

<p>LimitRules are derived from koha-conf.xml: + default limit counts, and counting method + branch specific limit counts &#38; counting method + borrower category specific limit counts &#38; counting method + err on the side of caution: a counting fail will cause fail, even if the other counts passes.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="requires_moderation"
>requires_moderation</a></h3>

<pre>    my $status = $illRequest-&#62;requires_moderation;</pre>

<p>Return the name of the status if moderation by staff is required; or 0 otherwise.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="biblio"
>biblio</a></h3>

<pre>    my $biblio = $request-&#62;biblio;</pre>

<p>For a given request, return the biblio associated with it, or undef if none exists</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="check_out"
>check_out</a></h3>

<pre>    my $stage_summary = $request-&#62;check_out;</pre>

<p>Handle the check_out method. The first stage involves gathering the required data from the user via a form, the second stage creates an item and tries to issue it to the patron. If successful, it notifies the patron, then it returns a summary of how things went</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="generic_confirm"
>generic_confirm</a></h3>

<pre>    my $stage_summary = $illRequest-&#62;generic_confirm;</pre>

<p>Handle the generic_confirm extended method. The first stage involves creating a template email for the end user to edit in the browser. The second stage attempts to submit the email.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="send_patron_notice"
>send_patron_notice</a></h3>

<pre>    my $result = $request-&#62;send_patron_notice($notice_code);</pre>

<p>Send a specified notice regarding this request to a patron</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="send_staff_notice"
>send_staff_notice</a></h3>

<pre>    my $result = $request-&#62;send_staff_notice($notice_code);</pre>

<p>Send a specified notice regarding this request to staff</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="get_notice"
>get_notice</a></h3>

<pre>    my $notice = $request-&#62;get_notice($params);</pre>

<p>Return a compiled notice hashref for the passed notice code and transport type</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="attach_processors"
>attach_processors</a></h3>

<p>Receive a Koha::Illrequest::SupplierUpdate and attach any processors we have for it</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="append_to_note"
>append_to_note</a></h3>

<pre>    append_to_note(&#34;Some text&#34;);</pre>

<p>Append some text to the staff note</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="id_prefix"
>id_prefix</a></h3>

<pre>    my $prefix = $record-&#62;id_prefix;</pre>

<p>Return the prefix appropriate for the current Illrequest as derived from the borrower and branch associated with this request&#39;s Status, and the config file.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_censor"
>_censor</a></h3>

<pre>    my $params = $illRequest-&#62;_censor($params);</pre>

<p>Return $params, modified to reflect our censorship requirements.</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="store"
>store</a></h3>

<pre>    $Illrequest-&#62;store;</pre>

<p>Overloaded <i>store</i> method that, in addition to performing the &#39;store&#39;, possibly records the fact that something happened</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="requested_partners"
>requested_partners</a></h3>

<pre>    my $partners_string = $illRequest-&#62;requested_partners;</pre>

<p>Return the string representing the email addresses of the partners to whom a request has been sent</p>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="TO_JSON"
>TO_JSON</a></h3>

<pre>    $json = $illrequest-&#62;TO_JSON</pre>

<p>Overloaded <i>TO_JSON</i> method that takes care of inserting calculated values into the unblessed representation of the object.</p>

<p>TODO: This method does nothing and is not called anywhere. However, bug 74325 touches it, so keeping this for now until both this and bug 74325 are merged, at which point we can sort it out and remove it completely</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Internal_methods"
>Internal methods</a></h2>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="to_api_mapping"
>to_api_mapping</a></h3>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="strings_map"
>strings_map</a></h3>

<pre>    my $strings = $self-&#62;string_map({ [ public =&#62; 0|1 ] });</pre>

<p>Returns a map of column name to string representations. Extra information is returned depending on the column characteristics as shown below.</p>

<p>Accepts a param hashref where the <i>public</i> key denotes whether we want the public or staff client strings.</p>

<p>Example:</p>

<pre>    {
        status =&#62; {
            backend =&#62; &#39;backendName&#39;,
            str     =&#62; &#39;Status description&#39;,
            type    =&#62; &#39;ill_status&#39;,
        },
        status_alias =&#62; {
            category =&#62; &#39;ILL_STATUS_ALIAS,
            str      =&#62; $value, # the AV description, depending on $params-&#62;{public}
            type     =&#62; &#39;av&#39;,
        }
    }</pre>

<h3><a class='u' href='#___top' title='click to go to top of document'
name="_type"
>_type</a></h3>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHOR"
>AUTHOR</a></h1>

<p>Alex Sassmannshausen &#60;alex.sassmannshausen@ptfs-europe.com&#62; Andrew Isherwood &#60;andrew.isherwood@ptfs-europe.com&#62;</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
